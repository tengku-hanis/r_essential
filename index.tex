% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrreprt}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{5}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother


% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}



\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\usepackage{caption}
\usepackage{anyfontsize}
\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={R Essentials: A Beginner's Guide to Data Analysis},
  pdfauthor={Tengku Muhammad Hanis Bin Tengku Mokhtar, PhD},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{R Essentials: A Beginner's Guide to Data Analysis}
\author{Tengku Muhammad Hanis Bin Tengku Mokhtar, PhD}
\date{Nov 23, 2025}
\begin{document}
\maketitle

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}

\bookmarksetup{startatroot}

\chapter*{Welcome}\label{welcome}
\addcontentsline{toc}{chapter}{Welcome}

\markboth{Welcome}{Welcome}

\begin{tcolorbox}[enhanced jigsaw, arc=.35mm, toprule=.15mm, colframe=quarto-callout-warning-color-frame, breakable, leftrule=.75mm, colback=white, title=\textcolor{quarto-callout-warning-color}{\faExclamationTriangle}\hspace{0.5em}{This book is currently in its drafting stages and has not yet been
published. While all the chapters are complete, most of them are still
undergoing further revision and refinement.}, opacitybacktitle=0.6, bottomtitle=1mm, left=2mm, bottomrule=.15mm, coltitle=black, opacityback=0, rightrule=.15mm, toptitle=1mm, titlerule=0mm, colbacktitle=quarto-callout-warning-color!10!white]

\end{tcolorbox}

This book is intended for anyone interested in using R for applied
statistical analysis and machine learning. I first encountered R
(specifically RStudio) during my master's studies, and it wasn't an easy
journey---especially as someone from a non-coding background. Initially,
I was introduced to software like SPSS and STATA, and eventually R
during my master's studies. R felt unfamiliar and complex by comparison
to the previous software. However, those who could use R proficiently
seemed impressive to me, which motivated me to keep going. Surprisingly,
the learning process became much easier as I keep using R.

Looking back, I wish I had known certain things earlier in my journey of
learning R. This book is my attempt to provide those insights, covering
the key concepts and tips I wish I had had when I started. I hope it
sparks interest in R for others and helps them fully utilize its
capabilities.

Finally, I just want to say thanks to my lovely wife, Nurul Asmaq, my
parents, Tengku Mokhtar and Nor Malaysia, and my in-laws, Mazalan and
Salmeh, for all their understanding. Writing this book means taking the
time I would usually spend with them, and while they might not fully get
my obsession with R and data analysis (especially my wife!), they've
supported me every step of the way.

\href{https://tengkuhanis.netlify.app/}{Tengku Muhammad Hanis Bin Tengku
Mokhtar, PhD}

\bookmarksetup{startatroot}

\chapter*{About the book}\label{about-the-book}
\addcontentsline{toc}{chapter}{About the book}

\markboth{About the book}{About the book}

\begin{tcolorbox}[enhanced jigsaw, arc=.35mm, toprule=.15mm, colframe=quarto-callout-warning-color-frame, breakable, leftrule=.75mm, colback=white, title=\textcolor{quarto-callout-warning-color}{\faExclamationTriangle}\hspace{0.5em}{This book is currently in its drafting stages and has not yet been
published. While all the chapters are complete, most of them are still
undergoing further revision and refinement.}, opacitybacktitle=0.6, bottomtitle=1mm, left=2mm, bottomrule=.15mm, coltitle=black, opacityback=0, rightrule=.15mm, toptitle=1mm, titlerule=0mm, colbacktitle=quarto-callout-warning-color!10!white]

\end{tcolorbox}

This book is designed for beginner and novice R users, with chapters
structured sequentially to introduce R step-by-step, starting with
foundational topics and progressing to more complex material.

Chapters 1 to 3 introduce readers to R and RStudio. For those already
somewhat familiar with R, these chapters may seem straightforward and
can be skipped without issue.

Chapters 4 and 5 provide essential knowledge on basic R coding, commonly
used in data analysis projects. It is advised to read these chapters
thoroughly before moving on, as they lay the groundwork for more
advanced topics.

Chapter 6 focuses on basic visualizations and plotting techniques.
Readers will learn how to use base R functions for visual representation
and will be introduced to \texttt{ggplot2}, a highly regarded package
for data visualisation in R.

Chapter 7 covers loop, apply family, and function, topics that may pose
a challenge for beginners. This chapter aims to equip readers with the
skills needed for more efficient R coding. While not critical for
initial learning, understanding these concepts will become increasingly
important as one progresses in data analysis.

Chapters 8 and 9 delve into essential skills for data exploration and
descriptive statistics. Mastering these will enable readers to gain
deeper insights into their data and prepare them for more advanced
analysis techniques.

Chapter 10 concludes the book by summarizing previous content and
offering guidance on next steps to further enhance R and data analysis
skills.

Each chapter kicks off with a quote---I hope you enjoy it! To wrap
things up, each chapter ends with chapter summary and revision
questions.

Happy learning!

\bookmarksetup{startatroot}

\chapter{What is R?}\label{what-is-r}

\begin{quote}
``Busses are very easy to use, you just need to know which bus to get
on, where to get on, and where to get off (and you need to pay your
fare). Cars, on the other hand, require much more work: you need to have
some type of map or directions (even if the map is in your head), you
need to put gas in every now and then, you need to know the rules of the
road (have some type of drivers license). The big advantage of the car
is that it can take you a bunch of places that the bus does not go and
it is quicker for some trips that would require transferring between
busses.

Using this analogy, programs like SPSS are busses, easy to use for the
standard things, but very frustrating if you want to do something that
is not already preprogrammed.

R is a 4-wheel drive SUV (though environmentally friendly) with a bike
on the back, a kayak on top, good walking and running shoes in the
passenger seat, and mountain climbing and spelunking gear in the back.

R can take you anywhere you want to go if you take time to learn how to
use the equipment, but that is going to take longer than learning where
the bus stops are in SPSS.''

-- Greg Snow
\end{quote}

\section{R}\label{r}

R is a language and environment for statistical computing and graphics.

That basically summarises this whole chapter.

\begin{figure}

\centering{

\includegraphics[width=0.25\linewidth,height=\textheight,keepaspectratio]{figs/ch2/r_logo.png}

}

\caption{\label{fig-r-logo}The logo of R software.}

\end{figure}%

Readers who are not interested in knowing more about R and its history
can skip this chapter and move on to more practical chapters.

Well, for those who keep reading this, I guess you are interested to
know more about the story of how R came to be. Do not worry, this
chapter is only going to cover a short version of the history of R, so,
that we can appreciate this software.

R was a successor of S language. It was developed by Ross Ihaka and
Robert Gentleman at the University of Auckland in 1991. R was made known
to the public only in 1993. The R version 1.0.0 was released in 2000.

\section{RStudio and Posit}\label{rstudio-and-posit}

\begin{figure}

\centering{

\includegraphics[width=0.45\linewidth,height=\textheight,keepaspectratio]{figs/ch2/rstudio_logo.png}

}

\caption{\label{fig-rstudio-logo}The logo of RStudio.}

\end{figure}%

In 2009, a company known as RStudio, Inc.~was founded by Joseph J.
Allaire, which later developed the RStudio software. RStudio software is
an integrated development environment (IDE) which helps make R more
user-friendly, especially for those without a programming background.
\href{https://posit.co/downloads/}{RStudio IDE} is unequivocally the
most commonly used IDE for R software. The company, RStudio, Inc.~later
changed its corporation to a public benefit corporation (PBC) in 2020,
thus, known as RStudio, PBC. Subsequently, in 2022, the company changed
its name to \href{https://posit.co/}{Posit Software, PBC} to cater to a
larger demography of the data science community.

\begin{figure}

\centering{

\includegraphics[width=0.45\linewidth,height=\textheight,keepaspectratio]{figs/ch2/posit.png}

}

\caption{\label{fig-posit-logo}The logo of Posit Software, PBC.}

\end{figure}%

Despite the changes in Posit company, they still strongly support the
development and maintenance of RStudio IDE specifically and R in
general.

\section{Other IDEs}\label{other-ides}

As you may have guessed, we going to use RStudio in this book. However,
there are other IDEs available. A few that are more common are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \href{https://jupyter.org/try}{Jupyter Notebook}
\item
  \href{https://jupyter.org/try}{JupyterLab}
\item
  \href{https://code.visualstudio.com/docs/languages/r}{Visual Studio}
\end{enumerate}

Given that RStudio is initially developed for R (currently we can use
Python as well in RStudio), a lot of functionalities work seamlessly
with R. Thus, make it easier for R beginners and novices to use it.

\section{Clouds}\label{clouds}

There are a few options to use R in a cloud. Meaning that we do not need
to install anything on our machines.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \href{https://posit.cloud/}{Posit Cloud}
\item
  \href{https://colab.research.google.com/}{Google Colab}
\item
  \href{https://www.kaggle.com/}{Kaggle}
\end{enumerate}

The first two clouds are free with limited use, though you need to make
an account. Kaggle is totally free to use as far as I know. However,
Kaggle does not have functions such as code completion which is very
helpful to beginners. This function is available in the first two
clouds.

However, if you are looking for something more familiar to RStudio,
Posit Cloud is the best choice. The functionalities and the overall look
of the Posit Cloud are identical to RStudio.

\begin{figure}

\centering{

\pandocbounded{\includegraphics[keepaspectratio]{figs/ch2/posit_cloud.JPG}}

}

\caption{\label{fig-posit-cloud}The interface of RStudio in Posit
Cloud.}

\end{figure}%

\section{Chapter summary}\label{chapter-summary}

In this chapter, we learn about what are R and RStudio.

\section{Revision}\label{revision}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  What is the difference between R and RStudio IDE?
\item
  What is the difference between RStudio IDE, RStudio, Inc., and
  RStudio, PBC?
\item
  What are other IDEs for R?
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Installing R and RStudio}\label{installing-r-and-rstudio}

\begin{quote}
``Everyone should learn how to code, it teaches you how to think.''

-- Steve Jobs
\end{quote}

\section{Installing R}\label{installing-r}

R can be installed regardless of your operating system. R is available
for Windows, Mac, and Linux users. This page
(\url{https://cran.r-project.org/}) contains all the necessary
information needed to install R. Additionally, if you are stuck, I
highly recommend you to watch a few YouTube videos on how to install R.

\section{Installing RStudio}\label{installing-rstudio}

Once you have installed R, you need to install RStudio IDE. This page
(\url{https://posit.co/download/rstudio-desktop/}) contains all the
information including the related links necessary to download and
install RStudio. Again, if you are stuck, I highly recommend you watch a
few YouTube videos on how to install RStudio.

\section{Installing RTools}\label{installing-rtools}

This process is specific to Windows users only. If you are a Linux or
Mac user, feel free to skip this part. Rtools is a collection of tools
required to build R packages from source on Windows systems. Basically,
you need RTools to install the unofficial packages from GitHub, GitLab
or other repositories. We going to cover what are R packages in the
Section~\ref{sec-basic-r-packages}. For now, just know that to fully
utilise the capabilities of R, you need to have RTools in your machine.

This page
(\url{https://cran.r-project.org/bin/windows/Rtools/rtools40.html})
contains all the necessary information on how to install RTools on your
machine. The basic steps as outlined on the page are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Download RTools
\item
  Install the RTools
\item
  Put RTools on the PATH
\end{enumerate}

\section{Other alternatives}\label{other-alternatives}

On the rare occasion that you are unable to install R or RStudio, you
always have the option to use the Posit Cloud. As long as you have a
Google account, you should be able to use the Posit Cloud freely. The
free account is limited, however, it is more than enough for you to use
throughout this book. Additionally, you can use the Google Colab,
though, the user interface is slightly different to RStudio.

\section{Chapter summary}\label{chapter-summary-1}

In this chapter, we learn how to install R and RStudio.

\section{Revision}\label{revision-1}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  What is RTools?
\item
  What are the options if you can not install R and RStudio?
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Introduction to RStudio}\label{introduction-to-rstudio}

\begin{quote}
``When I wrote this code, only God and I understood what I did. Now only
God knows.''

-- Anonymous
\end{quote}

\section{Panes in RStudio}\label{panes-in-rstudio}

The first time we open RStudio we will see three panes as in
Figure~\ref{fig-rstudio-interface}.

\begin{figure}

\centering{

\pandocbounded{\includegraphics[keepaspectratio]{figs/ch4/rstudio-interface.png}}

}

\caption{\label{fig-rstudio-interface}RStudio interface.}

\end{figure}%

Pane 1 consists of three tabs:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Console - This pane is where R codes can be typed and executed. The
  console also is where the output will be displayed. However, any R
  codes typed into the console can not be saved.
\item
  Terminal - This is a command-line interface that allows users to
  interact with the system shell, much like other terminal applications
  on your computer. It supports tasks such as navigating the file
  system, running command-line tools, and managing files, which can be
  useful for integrating non-R tasks into your workflow. However, for
  beginners, this tab is relatively unimportant.
\item
  Background Jobs - This pane enables users to run R scripts in the
  background without interrupting ongoing work in the Console. This
  feature is helps run long or complex tasks, as you can continue coding
  or working in the RStudio environment while the script executes
  independently.
\end{enumerate}

Next, Pane 2 consists of four tabs:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Environment - This pane displays all the active objects in the current
  R session, such as data frames, variables, functions, and vectors.
\item
  History - This pane keeps a record of all commands that have been
  executed in the R console during the session
\item
  Connections - This pane facilitates managing database connections
  within RStudio. It allows users to connect to external databases, view
  database contents, and run SQL queries directly from the IDE.
\item
  Tutorial - The Tutorial pane is part of RStudio's \texttt{learnr}
  package, which hosts interactive tutorials directly within the IDE.
\end{enumerate}

Lastly, Pane 3 consists of five tabs:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Files - This pane allows users to navigate, create, delete, and manage
  files within the current working directory. It helps in organizing
  project files, accessing scripts, data files, and outputs.
\item
  Plots - This pane displays graphical output generated by R code, such
  as charts, graphs, and plots.
\item
  Packages - This pane shows a list of installed R packages and their
  status (loaded or not). It also allows users to install, remove, or
  update packages, providing an easy way to manage package dependencies
  for projects.
\item
  Help - This pane provides access to documentation for R functions,
  packages, and commands.
\item
  Viewer - The Viewer pane is used for displaying web content such as
  interactive visualizations, markdown files, and other HTML outputs
  directly within RStudio.
\item
  Presentation - This pane supports presenting R Markdown or Quarto
  documents in an interactive format. For example, if you are making a
  slide or HTML presentation, it will appear in this pane.
\end{enumerate}

The information can be quite overwhelming, especially if you are new to
R and RStudio. At this moment, you do not actually need to know every
detail functionalities of each pane and tab yet. Once you become more
familiar with RStudio, all this information will become second-hand to
you.

\section{Working directory}\label{working-directory}

In Figure~\ref{fig-rstudio-interface}, we have a Files tab in Pane 3.
This is usually where your working directory is located. However, we can
also check using the R code below:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{getwd}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Additionally, the working directory can also be changed to your
preferred location.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{"C:/Users/tengk/OneDrive/Desktop"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Here, I changed my working directory to my desktop folder. A good
practice when running the analysis in R is to set up your working
directory before you start any analysis project. So, any outputs and
figures generated during the analysis will be saved in your preferred
working directory.

\section{R script}\label{r-script}

One of the few things to do before running the analysis project (besides
setting up the working directory) is to type the R codes in the R
script. R scripts is a plain text file with the extension .R. R script
can be saved and the R codes in it can be re-run if needed.

There are a few ways to open the R script.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Click on File (upper left side of RStudio) \textgreater{} New File
  \textgreater{} R Script.
\item
  Click on the green plus button (below the File tab) \textgreater{} R
  Script as shown in Figure~\ref{fig-rsript1}.
\end{enumerate}

\begin{figure}

\centering{

\includegraphics[width=0.7\linewidth,height=\textheight,keepaspectratio]{figs/ch4/rscript1.JPG}

}

\caption{\label{fig-rsript1}Opening the R Script.}

\end{figure}%

Once you manage to open the R Script, you will see an additional pane as
shown in Figure~\ref{fig-rscript2}.

\begin{figure}

\centering{

\pandocbounded{\includegraphics[keepaspectratio]{figs/ch4/rscript2.png}}

}

\caption{\label{fig-rscript2}R Script interface.}

\end{figure}%

The R Script can be saved and additionally, at the lower right side of
the pane, we can see \texttt{R\ Script}, confirming that this newly open
file is an R Script.

\section{Updating R and RStudio}\label{updating-r-and-rstudio}

\texttt{installr} package can be used to update R. You will what is an R
package and how to install it in \hyperref[packages]{Chapter 5}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{installr}\SpecialCharTok{::}\FunctionTok{updateR}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Once you run \texttt{installr::updateR()} either in the Console or R
Script, this package will check whether there is a newer version of R or
not. If the newer version of R is available, this package installs the
newer version after asking a series of questions such as do you want to
transfer your old packages to the new version of R and whether you want
to update the packages or not.

To update the RStudio, you can click the Help tab (at the top of the
RStudio) \textgreater{} Check for Updates.

\begin{figure}

\centering{

\includegraphics[width=0.8\linewidth,height=\textheight,keepaspectratio]{figs/ch4/update-rstudio.png}

}

\caption{\label{fig-update-rstudio}Updating RStudio}

\end{figure}%

\section{Chapter summary}\label{chapter-summary-2}

In this chapter, we learn about:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Basic interface of RStudio.
\item
  How to set up the working directory.
\item
  How to update R and RStudio.
\end{enumerate}

\section{Revision}\label{revision-2}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Change your working directory to your desktop.
\item
  Try creating a new R Script, rename it as Test.R, and save it in your
  new working directory.
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Basics of R}\label{basics-of-r}

\begin{quote}
``Confusion is part of programming.''

-- Felienne Hermans
\end{quote}

\section{Getting help}\label{getting-help}

Probably the most basic thing to know is how to get help in R. Besides a
quick Google search or asking ChatGPT, R also provides a help function.
The help function can be accessed using \texttt{?}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?}\FunctionTok{mean}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

The code above will open the \texttt{Help} pane, which explains what the
function \texttt{mean()} does.

\begin{figure}

\centering{

\includegraphics[width=0.8\linewidth,height=\textheight,keepaspectratio]{figs/ch5/help.JPG}

}

\caption{\label{fig-help}The Help pane in RStudio.}

\end{figure}%

\section{Executing the code}\label{executing-the-code}

The codes can be typed either in R Script or Console. The code in R
Scripts can be executed by placing the cursor at any line of the codes
and clicking \texttt{Ctrl} + \texttt{Enter} in Windows and \texttt{Cmd}
+ \texttt{Enter} in Macs.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Example 1: A single line of code}
\FunctionTok{mean}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{) }

\CommentTok{\# Example 2: A multiple lines of code}
\FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\FloatTok{10.6}\NormalTok{, }\FloatTok{11.9}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mean}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{round}\NormalTok{(}\AttributeTok{digits =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

In the second example (example of multiple lines of code), a cursor can
be placed at any line of code. Additionally, the codes in the Console
can be executed by clicking \texttt{Enter} only. If you want to run any
code in this book, you should copy and paste it into the R Script
instead of the Console, especially if there are multiple lines of code.
Notably, the codes should be run in sequence unless the current line of
codes is independent from the previous line of codes.

\section{Data types in R}\label{data-types-in-r}

There are a few data types in R:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Numeric
\item
  Integer
\item
  Logical
\item
  Character
\item
  Complex
\end{enumerate}

Let us see the example in R:

For the numeric:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1 }\OtherTok{\textless{}{-}} \DecValTok{11}
\NormalTok{x2 }\OtherTok{\textless{}{-}} \FloatTok{11.9}

\FunctionTok{class}\NormalTok{(x1); }\FunctionTok{class}\NormalTok{(x2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "numeric"
\end{verbatim}

\begin{verbatim}
[1] "numeric"
\end{verbatim}

Both numbers are recognised as numeric in R. For integers, the number
should be denoted by `L' to be recognised as an integer.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x3 }\OtherTok{\textless{}{-}} \DecValTok{11}\NormalTok{L}

\FunctionTok{class}\NormalTok{(x3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "integer"
\end{verbatim}

For logical values, the boolean operators such as `FALSE' and `TRUE' are
examples of logical values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x4 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{)}

\FunctionTok{class}\NormalTok{(x4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "logical"
\end{verbatim}

Next, we have character values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x5 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"fruit"}\NormalTok{, }\StringTok{"apple"}\NormalTok{)}

\FunctionTok{class}\NormalTok{(x5)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "character"
\end{verbatim}

Lastly, we have complex values. The type of data is usually used to
store numbers and imaginary components (for example, \texttt{i} in the
code below).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x6 }\OtherTok{\textless{}{-}} \DecValTok{9} \SpecialCharTok{+} \DecValTok{3}\NormalTok{i}

\FunctionTok{class}\NormalTok{(x6)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "complex"
\end{verbatim}

It is important to note the data type for each value as the function for
numeric values can only be applied to numeric values. For example, if we
want to find a mean value.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{numeric\_val }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10} \CommentTok{\#list out all numbers between 1 and 10}
\NormalTok{numeric\_val}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{character\_val }\OtherTok{\textless{}{-}}\NormalTok{ letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{] }\CommentTok{\#list out the first 10 alphabets}
\NormalTok{character\_val}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] "a" "b" "c" "d" "e" "f" "g" "h" "i" "j"
\end{verbatim}

Now, let us try applying the mean function to both data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(numeric\_val)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(character\_val)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Warning in mean.default(character_val): argument is not numeric or logical:
returning NA
\end{verbatim}

\begin{verbatim}
[1] NA
\end{verbatim}

So, R gives us a warning that the `character\_val' is not a numeric or
logical value. Thus, the returning NA mean not available.

\section{Data structure in R}\label{data-structure-in-r}

There are a few data structures in R:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Vector
\item
  Matrix
\item
  Array
\item
  Data frame
\item
  List
\end{enumerate}

\begin{figure}

\centering{

\includegraphics[width=0.8\linewidth,height=\textheight,keepaspectratio]{figs/ch5/data_structure.png}

}

\caption{\label{fig-data-structure}Data structures in R.}

\end{figure}%

Depending on the fields, certain data structures are more common
compared to others.

\subsection{Vector}\label{vector}

Vector is the most basic data structure in R. It can contain one data
type at a time.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vec\_data }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{vec\_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3 4
\end{verbatim}

The structure of the data can be checked using the function
\texttt{str()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(vec\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 num [1:4] 1 2 3 4
\end{verbatim}

We can further confirm whether \texttt{vec\_data} is a vector or not by
using the \texttt{is.vector()} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.vector}\NormalTok{(vec\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

A \texttt{TRUE} result indicates that the data is a vector type.

\subsection{Matrix}\label{matrix}

A matrix contains at least a single row and a single column. Contrary,
to a vector which contains only a single row or a single column.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mat\_data }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\AttributeTok{data =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{mat\_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6
\end{verbatim}

By using \texttt{str()} function, we can see that the values are
numerical and we have a matrix with 3 rows and 2 columns.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(mat\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 num [1:3, 1:2] 1 2 3 4 5 6
\end{verbatim}

Next, we can confirm that our data is a matrix by using
\texttt{is.matrix()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.matrix}\NormalTok{(mat\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\subsection{Array}\label{array}

An array is quite similar to a matrix except that it can contain several
layers of rows and columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{arr\_data }\OtherTok{\textless{}{-}} \FunctionTok{array}\NormalTok{(}\AttributeTok{data =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{, }\DecValTok{10}\SpecialCharTok{:}\DecValTok{16}\NormalTok{), }\AttributeTok{dim =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\NormalTok{arr\_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
, , 1

     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

, , 2

     [,1] [,2] [,3]
[1,]   10   12   14
[2,]   11   13   15
\end{verbatim}

As we can see, we have an array of 2 layers with each layer having 2
rows and 3 columns. By using the \texttt{str()} function, we can see
that R recognises the array has integer values with 3 dimensions. The
first dimension, \texttt{1:2} refers to the rows, the second dimension,
\texttt{1:3} refers to the columns, and the last dimension, \texttt{1:2}
refers to the layers.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(arr\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 int [1:2, 1:3, 1:2] 1 2 3 4 5 6 10 11 12 13 ...
\end{verbatim}

\texttt{is.array()} can be used to ensure the data structure.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.array}\NormalTok{(arr\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\subsection{Data frame}\label{data-frame}

A data frame is the extension of the matrix data structure. The
difference between the former and the latter, the former contains the
column names and each column may contain different data types.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{ID =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,}
  \AttributeTok{Name =} \FunctionTok{c}\NormalTok{(}\StringTok{"Mamat"}\NormalTok{, }\StringTok{"Abu"}\NormalTok{, }\StringTok{"Ali"}\NormalTok{, }\StringTok{"Chong"}\NormalTok{, }\StringTok{"Eva"}\NormalTok{),}
  \AttributeTok{Age =} \FunctionTok{c}\NormalTok{(}\DecValTok{25}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{22}\NormalTok{, }\DecValTok{35}\NormalTok{, }\DecValTok{28}\NormalTok{),}
  \AttributeTok{Score =} \FunctionTok{c}\NormalTok{(}\DecValTok{89}\NormalTok{, }\DecValTok{95}\NormalTok{, }\DecValTok{76}\NormalTok{, }\DecValTok{88}\NormalTok{, }\DecValTok{92}\NormalTok{)}
\NormalTok{)}
\NormalTok{df\_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  ID  Name Age Score
1  1 Mamat  25    89
2  2   Abu  30    95
3  3   Ali  22    76
4  4 Chong  35    88
5  5   Eva  28    92
\end{verbatim}

We can further check the data structure and type using \texttt{str()}.
So, our data structure is a data frame, consisting of 4 columns; the
first column is an integer, the second column is a character, third and
fourth columns are numeric.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(df\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   5 obs. of  4 variables:
 $ ID   : int  1 2 3 4 5
 $ Name : chr  "Mamat" "Abu" "Ali" "Chong" ...
 $ Age  : num  25 30 22 35 28
 $ Score: num  89 95 76 88 92
\end{verbatim}

We can double-check the data structure using \texttt{is.data.frame()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.data.frame}\NormalTok{(df\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\subsection{List}\label{list}

Lastly, we have a list. So, the list is a more advanced data structure
in which we can have different data structures in a data structure. Let
us see the example of a list in which we combine the previous vector and
matrix data structures.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{list\_data }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \StringTok{"vector"} \OtherTok{=}\NormalTok{ vec\_data,}
  \StringTok{"matrix"} \OtherTok{=}\NormalTok{ mat\_data}
\NormalTok{)}
\NormalTok{list\_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$vector
[1] 1 2 3 4

$matrix
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6
\end{verbatim}

We can further assess each data in the list using the \texttt{\$}
symbol.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{list\_data}\SpecialCharTok{$}\NormalTok{vector}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1 2 3 4
\end{verbatim}

By using \texttt{str()}, we see our data is a list with 2 elements or
components; a vector and matrix.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(list\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
List of 2
 $ vector: num [1:4] 1 2 3 4
 $ matrix: num [1:3, 1:2] 1 2 3 4 5 6
\end{verbatim}

To further confirm our data is a list, we can use \texttt{is.list()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.list}\NormalTok{(list\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

\section{Data in R}\label{data-in-r}

R itself contains the internal data that you can load for practice or
other purposes. You can run \texttt{data()} in the Console to see what
are the data available in R.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

So, for example, if you want to load any of these data, you can type the
name of the datasets. You will see under the \texttt{Environment} pane,
the chickWeight dataset is loaded to your environment.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"ChickWeight"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Additionally, it is quite common that R packages have their own datasets
as well. We will see this many times in this book going forward. Lastly,
R is capable of reading different data formats.

\begin{longtable}[]{@{}ll@{}}
\caption{Common data formats and corresponding R codes for reading
them.}\label{tbl-data-format}\tabularnewline
\toprule\noalign{}
Format & R codes \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
Format & R codes \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
.csv & \texttt{read.csv()} \\
.sav (SPSS) & \texttt{haven::read\_sav()} \\
.xlsx (Excel) & \texttt{readxl::read\_excel()} \\
.txt & \texttt{read.table()} \\
.dta (STATA) & \texttt{haven::read\_dta()} \\
\end{longtable}

The data formats that can be read are limited to the one listed in the
table. Almost all data formats can be read in R. An efficient way to
know whether R is capable of reading certain data formats by just a
quick Google search.

For the rest of the chapter we going to the \texttt{iris} dataset, which
is already available in R. To know more about this dataset, you can type
the below code in the console.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?iris}
\end{Highlighting}
\end{Shaded}

\section{Packages}\label{sec-basic-r-packages}

A package is a collection of functions and sample data that can be
utilised for certain tasks. Certain functions in R are already loaded
when you open R or RStudio. However, to use more advanced functions we
need to install and load a package.

The packages can installed using \texttt{install.packages()}. For
example, the code below will install the \texttt{dplyr} package which is
commonly utilised for data wrangling and manipulation.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"dplyr"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

To use the installed packages, we need to load the packages using the
\texttt{library()} function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

Now, that we know what is a package, we might wonder where exactly these
packages coming from.

The official packages in R are located in the
\href{https://cran.r-project.org/}{Comprehensive R Archive Network
(CRAN)}.
\href{https://cran.r-project.org/web/packages/available_packages_by_name.html}{This
link} contains all available packages in CRAN. Additionally, there is
\href{https://cran.r-project.org/web/views/}{CRAN Task Views}. At the
time of this writing, CRAN contains 21,606 R packages intended for
various tasks.

Furthermore, for those interested in bioinformatics, the related
packages are located in the
\href{https://www.bioconductor.org/packages/release/BiocViews.html\#___Software}{Bioconductor}.
At the time of this writing, Bioconductor contains 2,289 R packages
related to bioinformatics.

In addition to CRAN and Bioconductor, there are unofficial R packages,
which are usually located in \href{https://github.com/}{GitHub} and
\href{https://gitlab.com/r-packages}{GitLab}. There are probably
thousands of these unofficial packages. For example,
\href{https://github.com/MathiasHarrer/dmetar}{\texttt{dmetar}} which is
located in GitHub, contains R functions and codes to facilitate the
conduction of meta-analyses.

More often than not, the official packages in CRAN also have their
GitHub repositories in which they contain the latest development of R
functions and codes before they going to be released in CRAN. So,
current bugs and errors in the package are corrected first using the
unofficial packages from GitHub or GitLab before they are eventually
released to the CRAN repositories.

Several packages can help in installing the unofficial packages. The two
most commonly used packages are \texttt{devtools} and \texttt{remote}
(or at least I commonly used them).

First, we need to install the packages.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"devtools"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"remote"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Next, we can install the unofficial packages.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{devtools}\SpecialCharTok{::}\FunctionTok{install\_github}\NormalTok{(}\StringTok{"MathiasHarrer/dmetar"}\NormalTok{)}
\NormalTok{remotes}\SpecialCharTok{::}\FunctionTok{install\_github}\NormalTok{(}\StringTok{"MathiasHarrer/dmetar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{MathiasHarrer} refers to the GitHub account or usually the
author's account on GitHub, followed by the name of the package.
Depending on one's preference, we can choose to use either
\texttt{devtools} or \texttt{remote}.

\section{Functions}\label{functions}

A function in R is a block of code designed to perform a specific task.
It consists of an argument, in which we need to supply it. For example,
the \texttt{mean()} function is designed to find the mean or average
across the numeric values. The numeric values are the argument that we
need to supply to the function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{num\_values }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\FunctionTok{mean}\NormalTok{(num\_values)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7.25
\end{verbatim}

The base R itself has numerous functions that are accessible to us.
These base R functions can be used immediately once we open R (or
RStudio or any other IDEs). In contrast, we also have R functions from
the packages that we installed. First, we need to install the packages.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

We will learn about \texttt{tidyverse} in a little bit. Coming on to our
current installation, once you install the package there are two ways to
use the function inside the package. First, by loading the package,
subsequently, all the functions in the package are ready to be used by
us. For example below, \texttt{bind\_rows()} is one of the functions
from the \texttt{dplyr} package.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the package}
\FunctionTok{library}\NormalTok{(dplyr) }

\CommentTok{\# Example of functions from dplyr package}
\FunctionTok{bind\_rows}\NormalTok{()}
\FunctionTok{bind\_cols}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Secondly, we can use \texttt{::} to access a single function that we are
interested in. However, in this approach, only a single function is
loaded.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Example of dplyr functions}
\NormalTok{dplyr}\SpecialCharTok{::}\FunctionTok{bind\_rows}\NormalTok{()}
\NormalTok{dplyr}\SpecialCharTok{::}\FunctionTok{bind\_cols}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

As we can see, every time we want to call a function from the
\texttt{dplyr} package we type \texttt{dplyr::} as we do not load the
package first.

\section{Tidyverse package}\label{tidyverse-package}

We have learned that R packages contain a collection of functions and R
codes that we utilise once we load the packages. So, tidyverse is an
opinionated collection of R packages designed for data science (Wickham
et al. 2019).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# List of all packages in tidyverse}
\NormalTok{tidyverse}\SpecialCharTok{::}\FunctionTok{tidyverse\_packages}\NormalTok{(}\AttributeTok{include\_self =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Packages =}\NormalTok{ \_)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
        Packages
1          broom
2     conflicted
3            cli
4         dbplyr
5          dplyr
6         dtplyr
7        forcats
8        ggplot2
9    googledrive
10 googlesheets4
11         haven
12           hms
13          httr
14      jsonlite
15     lubridate
16      magrittr
17        modelr
18        pillar
19         purrr
20          ragg
21         readr
22        readxl
23        reprex
24         rlang
25    rstudioapi
26         rvest
27       stringr
28        tibble
29         tidyr
30          xml2
\end{verbatim}

Table~\ref{tbl-tidyverse-packages} below summarises common packages in
\texttt{tidyverse} and its uses.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 2\tabcolsep) * \real{0.5000}}
  >{\raggedright\arraybackslash}p{(\linewidth - 2\tabcolsep) * \real{0.5000}}@{}}
\caption{Common packages in
tidyverse.}\label{tbl-tidyverse-packages}\tabularnewline
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Packages
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Summary
\end{minipage} \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Packages
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Summary
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
ggplot2 & For data visualisation. \\
dplyr & Provides tools for data manipulation, including functions for
filtering, selecting, grouping, and summarizing data. \\
tidyr & Specializes in data tidying, allowing users to transform
datasets into a tidy format ready for analysis or visualisation. \\
readr & Used for reading rectangular data (e.g., CSV, TSV files) into R
quickly and efficiently. \\
purr & Introduces a functional programming paradigm in R with tools for
applying functions to data structures like lists and vectors. \\
tibble & Enhances data frames in R by making them more user-friendly
with better printing options and stricter type checking \\
stringr & Facilitates consistent handling of strings, offering functions
for string manipulation, pattern matching, and transformations. \\
forcats & Designed to work with categorical data (factors). \\
\end{longtable}

\texttt{Tidyverse} is commonly utilised for data analysis and throughout
this book, we going to use \texttt{tidyverse} functions numerous times.

\section{Pipe operators}\label{pipe-operators}

There are two types of pipe in R:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{\textbar{}\textgreater{}}: this pipe is from base R, first
  introduced in R version 4.1.0.
\item
  \texttt{\%\textgreater{}\%}: this pipe is from the \texttt{magrittr}
  package, which presented \texttt{tidyverse}.
\end{enumerate}

To use \texttt{\textbar{}\textgreater{}}, we do not actually need to
load anything as it is already available in base R. However, to use
\texttt{\%\textgreater{}\%}, you need to load \texttt{tidyverse}.
Certain \texttt{tidyverse} associated packages such as \texttt{dplyr},
\texttt{forcats}, and \texttt{magrittr} also load the
\texttt{\%\textgreater{}\%}.

The main function of these pipe operators (regardless of which one we
use) is to make our R codes more readable and intuitive. So, let us
compare the codes without and with the pipe.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mean\_value }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(}
  \FunctionTok{subset}\NormalTok{(}
    \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{value =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\AttributeTok{group =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{), }\AttributeTok{each =} \DecValTok{5}\NormalTok{)),}
\NormalTok{    group }\SpecialCharTok{==} \StringTok{"A"}
\NormalTok{  )}\SpecialCharTok{$}\NormalTok{value}
\NormalTok{)}
\NormalTok{mean\_value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3
\end{verbatim}

Now, compare the codes with the pipe.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mean\_value }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{value =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\AttributeTok{group =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{), }\AttributeTok{each =} \DecValTok{5}\NormalTok{)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{subset}\NormalTok{(group }\SpecialCharTok{==} \StringTok{"A"}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{with}\NormalTok{(}\FunctionTok{mean}\NormalTok{(value))}
\NormalTok{mean\_value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3
\end{verbatim}

Basically, what we do in both R codes are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Create a data frame with ten rows and two columns.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{value =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\AttributeTok{group =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{), }\AttributeTok{each =} \DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   value group
1      1     A
2      2     A
3      3     A
4      4     A
5      5     A
6      6     B
7      7     B
8      8     B
9      9     B
10    10     B
\end{verbatim}
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  Filter out the group column to value A.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{value =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\AttributeTok{group =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{), }\AttributeTok{each =} \DecValTok{5}\NormalTok{)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{subset}\NormalTok{(group }\SpecialCharTok{==} \StringTok{"A"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  value group
1     1     A
2     2     A
3     3     A
4     4     A
5     5     A
\end{verbatim}
\item
  Calculate the mean.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3
\end{verbatim}
\end{enumerate}

Coming back to both R codes, we can intuitively see that the codes with
the pipe are more readable and clear compared to the other one. The
codes with pipe can be read line by line, while the codes without the
pipe need to be read inside out. As you can imagine, once our codes are
more complex, the less readable the codes will become.

So, which pipe operators to choose?

In most cases, the differences are not significant enough to impact your
code. Therefore, you can choose the pipe operator that best suits your
preference or coding style. Most users will find that both options
perform similarly for general tasks, so selecting one often comes down
to familiarity or ease of use.

\texttt{\textbar{}\textgreater{}} is a built-in pipe operator which can
be used immediately without the need to load any package.
\texttt{\%\textgreater{}\%} can be used once the \texttt{tidyverse}
package is loaded. The latter pipe has short cut built-in in RStudio.
For Windows user, \texttt{Ctrl} + \texttt{Shift} + \texttt{M} and for
Mac user, \texttt{Cmd} + \texttt{Shift} + \texttt{M}. Additionally, we
can set up the shortcut for \texttt{\textbar{}\textgreater{}} or further
change the shortcut for \texttt{\%\textgreater{}\%}, though, this will
not be covered in this book.

\section{Chapter summary}\label{chapter-summary-3}

In this chapter, we learn about:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Data, its types and structures in R.
\item
  R packages and functions.
\item
  Pipe operators.
\end{enumerate}

\section{Revision}\label{revision-3}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  What this \texttt{?} actually do in R?
\item
  List all the data types that we learn in this chapter.
\item
  List all the data structures that we learn in this chapter.
\item
  What is the difference between installing the package and loading the
  package?
\item
  Which one to choose between \texttt{\textbar{}\textgreater{}} and
  \texttt{\%\textgreater{}\%}?
\item
  List three packages in \texttt{tidyverse} and summarise their
  functionalities.
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Data wrangling}\label{data-wrangling}

\begin{quote}
``Without clean data, or clean enough data, your data science is
worthless.''

--Michael Stonebraker
\end{quote}

Data wrangling refers to the process of transforming and preparing raw
data into a clean and structured format suitable for analysis. This
involves various steps, such as data cleaning, reshaping, merging, and
filtering, to ensure the dataset is ready for statistical analysis or
visualisation.

In most cases, data wrangling can occupy a significant portion of the
time required for data analysis, often more than other stages. In this
chapter, we will explore common operations in data wrangling. You will
learn how to perform these operations using either base R functions,
\texttt{tidyverse} functions, or both.

\section{Load packages}\label{load-packages}

The following packages will be used in this chapter. Please run these
lines of code before proceeding to other sections.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{Indexing}\label{sec-data-wrangle-index}

Indexing involves selecting specific elements within data structures,
which can be done using \texttt{{[}{]}}.

\subsection{Vector}\label{vector-1}

First, let's create a vector.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vec\_data }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{vec\_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

To select specific elements:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select a single element}
\NormalTok{vec\_data[}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select 3rd and 6th element}
\NormalTok{vec\_data[}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{,}\DecValTok{6}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 3 6
\end{verbatim}

\subsection{Data frame}\label{data-frame-1}

We will use \texttt{iris}, a built-in dataset in R, to demonstrate
indexing within a data frame. Detailed information about this dataset
can be accessed by typing \texttt{?iris} in the Console.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?iris}
\end{Highlighting}
\end{Shaded}

Below is a summary of this dataset.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(iris)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                
\end{verbatim}

We will use \texttt{{[}{]}}, where the general syntax is
\texttt{{[}row,\ column{]}}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Selecting the 1st row}
\NormalTok{iris[}\DecValTok{1}\NormalTok{, ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Selecting the 1st and 2nd row}
\NormalTok{iris[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
\end{verbatim}

Now let's see how to index columns.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Selecting the 1st row}
\NormalTok{iris[, }\DecValTok{1}\NormalTok{]}

\CommentTok{\# Selecting the 1st and 2nd row}
\NormalTok{iris[, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.1 4.9 4.7 4.6 5.0 5.4
\end{verbatim}

\begin{verbatim}
  Sepal.Length Sepal.Width
1          5.1         3.5
2          4.9         3.0
3          4.7         3.2
4          4.6         3.1
5          5.0         3.6
6          5.4         3.9
\end{verbatim}

By default, this shows the entire column, but here we'll limit the
output to the first six items for clarity.

Instead of numbers, we can also use column names:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Selecting the 1st row}
\NormalTok{iris[, }\StringTok{"Sepal.Length"}\NormalTok{]}

\CommentTok{\# Selecting the 1st and 2nd row}
\NormalTok{iris[, }\FunctionTok{c}\NormalTok{(}\StringTok{"Sepal.Length"}\NormalTok{, }\StringTok{"Sepal.Width"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.1 4.9 4.7 4.6 5.0 5.4
\end{verbatim}

\begin{verbatim}
  Sepal.Length Sepal.Width
1          5.1         3.5
2          4.9         3.0
3          4.7         3.2
4          4.6         3.1
5          5.0         3.6
6          5.4         3.9
\end{verbatim}

To select both a specific row and column, we can combine what we've
learned. For example, to select the first row and the first column:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Approach 1}
\NormalTok{iris[}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Approach 2}
\NormalTok{iris[}\DecValTok{1}\NormalTok{, }\StringTok{"Sepal.Length"}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.1
\end{verbatim}

To select the first five rows and the first two columns:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Approach 1}
\NormalTok{iris[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width
1          5.1         3.5
2          4.9         3.0
3          4.7         3.2
4          4.6         3.1
5          5.0         3.6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Approach 2}
\NormalTok{iris[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"Sepal.Length"}\NormalTok{, }\StringTok{"Sepal.Width"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width
1          5.1         3.5
2          4.9         3.0
3          4.7         3.2
4          4.6         3.1
5          5.0         3.6
\end{verbatim}

For selecting a single column, an easier approach is to use \texttt{\$}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris}\SpecialCharTok{$}\NormalTok{Petal.Length}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1.4 1.4 1.3 1.5 1.4 1.7
\end{verbatim}

\subsection{Selecting and slicing}\label{selecting-and-slicing}

In R, there are many ways to perform tasks. Rather than using
\texttt{{[}{]}}, \texttt{dplyr} provides \texttt{select()} and
\texttt{slice()}, which are often preferred for their readability. The
\texttt{dplyr} package is part of the \texttt{tidyverse}.

The \texttt{select()} function is used to choose specific columns.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select a single column}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Sepal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length
1          5.1
2          4.9
3          4.7
4          4.6
5          5.0
6          5.4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select several columns}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Sepal.Length, Sepal.Width)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width
1          5.1         3.5
2          4.9         3.0
3          4.7         3.2
4          4.6         3.1
5          5.0         3.6
6          5.4         3.9
\end{verbatim}

Similarly, \texttt{slice()} is used to extract specific rows.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select a single row}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice}\NormalTok{(}\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1          5.7         2.8          4.1         1.3 versicolor
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select several rows}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1          4.9         3.0          1.4         0.2     setosa
2          5.0         3.6          1.4         0.2     setosa
3          5.7         2.8          4.1         1.3 versicolor
\end{verbatim}

By combining both \texttt{select()} and \texttt{slice()}, we can access
specific rows and columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Sepal.Length) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length
1          5.1
2          4.9
3          4.7
4          4.6
5          5.0
\end{verbatim}

\section{Filtering}\label{filtering}

Filtering allows us to select rows based on a condition. For example, if
we want to filter the \texttt{Species} column for the value
\texttt{"setosa"} in the \texttt{iris} dataset, we start by creating an
index:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ind }\OtherTok{\textless{}{-}}\NormalTok{ iris}\SpecialCharTok{$}\NormalTok{Species }\SpecialCharTok{==} \StringTok{"setosa"}
\end{Highlighting}
\end{Shaded}

Next, we apply the index to the dataset.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris[ind, ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
\end{verbatim}

The \texttt{==} symbol is a logical operator.
Table~\ref{tbl-logical-operator} presents the most common logical
operators in R.

\begin{longtable}[]{@{}ll@{}}
\caption{Common logical operators in
R.}\label{tbl-logical-operator}\tabularnewline
\toprule\noalign{}
Operators & Description \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
Operators & Description \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textless{} & Less than \\
\textgreater{} & Greater than \\
\textless= & Less than or equal to \\
\textgreater= & Greater than or equal to \\
== & Equal to \\
!= & Not equal to \\
\end{longtable}

Alternatively, we can use \texttt{filter()} from \texttt{dplyr} for the
same result.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{"setosa"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa
\end{verbatim}

\texttt{filter()} is often more readable, especially for beginners,
though both methods yield the same output.

Additionally, we can combine multiple conditions using
\texttt{\textbar{}} (or) and \texttt{\&} (and). For instance, to filter
the \texttt{iris} dataset for rows where:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{Species} is \texttt{"setosa"}, and
\item
  \texttt{Sepal.Length} is greater than 5.6 cm:
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make an index}
\NormalTok{ind2 }\OtherTok{\textless{}{-}}\NormalTok{ iris}\SpecialCharTok{$}\NormalTok{Species }\SpecialCharTok{==} \StringTok{"setosa"} \SpecialCharTok{\&}\NormalTok{ iris}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{\textgreater{}} \FloatTok{5.6}

\CommentTok{\# Apply the index to the dataset}
\NormalTok{iris[ind2, ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
15          5.8         4.0          1.2         0.2  setosa
16          5.7         4.4          1.5         0.4  setosa
19          5.7         3.8          1.7         0.3  setosa
\end{verbatim}

Or, with \texttt{filter()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{"setosa"} \SpecialCharTok{\&}\NormalTok{ Sepal.Length }\SpecialCharTok{\textgreater{}} \FloatTok{5.6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.8         4.0          1.2         0.2  setosa
2          5.7         4.4          1.5         0.4  setosa
3          5.7         3.8          1.7         0.3  setosa
\end{verbatim}

\section{Sorting}\label{sorting}

Sorting arranges the rows of a data frame by specific column values.

To demonstrate, let's limit \texttt{iris} to its first ten rows for
easier display. Using \texttt{head()} will give the top ten rows, while
\texttt{tail()} provides the last rows.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_top10 }\OtherTok{\textless{}{-}}\NormalTok{ iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{head}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\NormalTok{iris\_top10}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1           5.1         3.5          1.4         0.2  setosa
2           4.9         3.0          1.4         0.2  setosa
3           4.7         3.2          1.3         0.2  setosa
4           4.6         3.1          1.5         0.2  setosa
5           5.0         3.6          1.4         0.2  setosa
6           5.4         3.9          1.7         0.4  setosa
7           4.6         3.4          1.4         0.3  setosa
8           5.0         3.4          1.5         0.2  setosa
9           4.4         2.9          1.4         0.2  setosa
10          4.9         3.1          1.5         0.1  setosa
\end{verbatim}

To sort by a single column, use \texttt{sort()}. Setting
\texttt{decreasing\ =\ FALSE} sorts in ascending order.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sort}\NormalTok{(iris\_top10}\SpecialCharTok{$}\NormalTok{Sepal.Length, }\AttributeTok{decreasing =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1] 4.4 4.6 4.6 4.7 4.9 4.9 5.0 5.0 5.1 5.4
\end{verbatim}

Another useful function is \texttt{order()}, which returns the indices
and can arrange the entire dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make an index}
\NormalTok{ind3 }\OtherTok{\textless{}{-}} \FunctionTok{order}\NormalTok{(iris\_top10}\SpecialCharTok{$}\NormalTok{Sepal.Length, }\AttributeTok{decreasing =} \ConstantTok{FALSE}\NormalTok{)}

\CommentTok{\# Apply the index to the dataset}
\NormalTok{iris\_top10[ind3, ]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
9           4.4         2.9          1.4         0.2  setosa
4           4.6         3.1          1.5         0.2  setosa
7           4.6         3.4          1.4         0.3  setosa
3           4.7         3.2          1.3         0.2  setosa
2           4.9         3.0          1.4         0.2  setosa
10          4.9         3.1          1.5         0.1  setosa
5           5.0         3.6          1.4         0.2  setosa
8           5.0         3.4          1.5         0.2  setosa
1           5.1         3.5          1.4         0.2  setosa
6           5.4         3.9          1.7         0.4  setosa
\end{verbatim}

With \texttt{tidyverse}, we have \texttt{arrange()}, equivalent to
\texttt{order()} in base R:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_top10 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(Sepal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1           4.4         2.9          1.4         0.2  setosa
2           4.6         3.1          1.5         0.2  setosa
3           4.6         3.4          1.4         0.3  setosa
4           4.7         3.2          1.3         0.2  setosa
5           4.9         3.0          1.4         0.2  setosa
6           4.9         3.1          1.5         0.1  setosa
7           5.0         3.6          1.4         0.2  setosa
8           5.0         3.4          1.5         0.2  setosa
9           5.1         3.5          1.4         0.2  setosa
10          5.4         3.9          1.7         0.4  setosa
\end{verbatim}

To sort in descending order, use \texttt{desc()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_top10 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1           5.4         3.9          1.7         0.4  setosa
2           5.1         3.5          1.4         0.2  setosa
3           5.0         3.6          1.4         0.2  setosa
4           5.0         3.4          1.5         0.2  setosa
5           4.9         3.0          1.4         0.2  setosa
6           4.9         3.1          1.5         0.1  setosa
7           4.7         3.2          1.3         0.2  setosa
8           4.6         3.1          1.5         0.2  setosa
9           4.6         3.4          1.4         0.3  setosa
10          4.4         2.9          1.4         0.2  setosa
\end{verbatim}

\section{Rename}\label{rename}

First, let's check the column names.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colnames}\NormalTok{(iris\_top10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"     
\end{verbatim}

Suppose we want to rename the \texttt{species} column to \texttt{type}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colnames}\NormalTok{(iris\_top10)[}\DecValTok{5}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"type"}
\end{Highlighting}
\end{Shaded}

Now, if we check the column names again:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colnames}\NormalTok{(iris\_top10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "type"        
\end{verbatim}

Alternatively, we can use the \texttt{rename()} function from
\texttt{dplyr}. Here, we will rename \texttt{Sepal.Length} to
\texttt{LengthofSepal}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Change the column name}
\NormalTok{iris\_top10 }\OtherTok{\textless{}{-}} 
\NormalTok{  iris\_top10 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{LengthofSepal =} \StringTok{"Sepal.Length"}\NormalTok{)}

\CommentTok{\# Check the column names}
\FunctionTok{colnames}\NormalTok{(iris\_top10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "LengthofSepal" "Sepal.Width"   "Petal.Length"  "Petal.Width"  
[5] "type"         
\end{verbatim}

\section{Create new column}\label{create-new-column}

Let's create a smaller iris dataset first.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_bottom10 }\OtherTok{\textless{}{-}} \FunctionTok{tail}\NormalTok{(iris, }\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Using base R functions, we can create a new column as follows:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_bottom10}\SpecialCharTok{$}\NormalTok{Sepal.Lengthx2 }\OtherTok{\textless{}{-}}\NormalTok{ iris\_bottom10}\SpecialCharTok{$}\NormalTok{Sepal.Length }\SpecialCharTok{*} \DecValTok{2}
\FunctionTok{head}\NormalTok{(iris\_bottom10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species Sepal.Lengthx2
141          6.7         3.1          5.6         2.4 virginica           13.4
142          6.9         3.1          5.1         2.3 virginica           13.8
143          5.8         2.7          5.1         1.9 virginica           11.6
144          6.8         3.2          5.9         2.3 virginica           13.6
145          6.7         3.3          5.7         2.5 virginica           13.4
146          6.7         3.0          5.2         2.3 virginica           13.4
\end{verbatim}

Here, we create a new variable \texttt{Sepal.Lengthx2} by multiplying
\texttt{Sepal.Length} by 2. Using \texttt{tidyverse}, we can achieve
this with \texttt{mutate()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_bottom10 }\OtherTok{\textless{}{-}} 
\NormalTok{  iris\_bottom10 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Sepal.Widthx2 =}\NormalTok{ Sepal.Width }\SpecialCharTok{*} \DecValTok{2}\NormalTok{)}
\FunctionTok{head}\NormalTok{(iris\_bottom10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species Sepal.Lengthx2
141          6.7         3.1          5.6         2.4 virginica           13.4
142          6.9         3.1          5.1         2.3 virginica           13.8
143          5.8         2.7          5.1         1.9 virginica           11.6
144          6.8         3.2          5.9         2.3 virginica           13.6
145          6.7         3.3          5.7         2.5 virginica           13.4
146          6.7         3.0          5.2         2.3 virginica           13.4
    Sepal.Widthx2
141           6.2
142           6.2
143           5.4
144           6.4
145           6.6
146           6.0
\end{verbatim}

\section{Change data format}\label{change-data-format}

Data can be structured in two primary formats:

\begin{itemize}
\tightlist
\item
  \textbf{Long format}: Each row represents a single observation.
\item
  \textbf{Wide format}: Each subject has one row, with variables across
  columns.
\end{itemize}

In long format, each row represents a single observation. This format is
commonly used for data manipulation and analysis. Let's create an
example of a long-format dataset. Here, five participants were given a
dietary supplement to reduce weight, and the data contains:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{id}: participant ID
\item
  \texttt{time}: either pre- or post-supplement
\item
  \texttt{weight}: participant's weight
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{) }

\CommentTok{\# Create a long format data}
\NormalTok{data\_long }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{id =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, }\AttributeTok{each =} \DecValTok{2}\NormalTok{),        }
  \AttributeTok{time =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Pre"}\NormalTok{, }\StringTok{"Post"}\NormalTok{), }\DecValTok{5}\NormalTok{),   }
  \AttributeTok{weight =}  \FunctionTok{sample}\NormalTok{(}\AttributeTok{x =} \DecValTok{60}\SpecialCharTok{:}\DecValTok{80}\NormalTok{, }\AttributeTok{size =} \DecValTok{10}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)              }
\NormalTok{  )}

\CommentTok{\# View the data}
\NormalTok{data\_long}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   id time weight
1   1  Pre     74
2   1 Post     78
3   2  Pre     73
4   2 Post     62
5   3  Pre     69
6   3 Post     77
7   4  Pre     70
8   4 Post     64
9   5  Pre     79
10  5 Post     73
\end{verbatim}

In wide format, each subject has a single row, with each measurement in
a separate column. Here is \texttt{data\_long} converted to wide format.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Create a wide format data}
\NormalTok{data\_wide }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{id =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,}
  \AttributeTok{Pre =} \FunctionTok{sample}\NormalTok{(}\DecValTok{60}\SpecialCharTok{:}\DecValTok{80}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{Post =} \FunctionTok{sample}\NormalTok{(}\DecValTok{60}\SpecialCharTok{:}\DecValTok{80}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# View the data}
\NormalTok{data\_wide}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  id Pre Post
1  1  74   77
2  2  78   70
3  3  73   64
4  4  62   79
5  5  69   73
\end{verbatim}

In the wide format, data is often easier to interpret. Converting
between long and wide formats is simple in R. To transform
\texttt{data\_wide} into long format, use \texttt{pivot\_longer()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_long2 }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_wide }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \DecValTok{2}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{names\_to =} \StringTok{"time"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"weight"}\NormalTok{)}
\NormalTok{data\_long2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 10 x 3
      id time  weight
   <int> <chr>  <int>
 1     1 Pre       74
 2     1 Post      77
 3     2 Pre       78
 4     2 Post      70
 5     3 Pre       73
 6     3 Post      64
 7     4 Pre       62
 8     4 Post      79
 9     5 Pre       69
10     5 Post      73
\end{verbatim}

For \texttt{pivot\_longer()}, we need to supply three arguments:

\begin{itemize}
\tightlist
\item
  \texttt{cols}: columns to be changed into a long format excluding the
  id column
\item
  \texttt{names\_to}: name of a new column which consist of column names
  from a wide format data
\item
  \texttt{values\_to}: name of a new column which consist of values from
  \texttt{cols}
\end{itemize}

To convert \texttt{data\_long2} back to wide format, use
\texttt{pivot\_wider()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_wide2 }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_long2 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{id\_cols =} \StringTok{"id"}\NormalTok{, }\AttributeTok{names\_from =} \StringTok{"time"}\NormalTok{, }\AttributeTok{values\_from =} \StringTok{"weight"}\NormalTok{)}
\NormalTok{data\_wide2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 5 x 3
     id   Pre  Post
  <int> <int> <int>
1     1    74    77
2     2    78    70
3     3    73    64
4     4    62    79
5     5    69    73
\end{verbatim}

To use \texttt{pivot\_wider()}, the three basic arguments needed are:

\begin{itemize}
\tightlist
\item
  \texttt{id\_cols}: ID column
\item
  \texttt{names\_from}: name of a column to get the column names for the
  wide data
\item
  \texttt{values\_from}: name of a column to get the values from
\end{itemize}

Both functions have additional arguments detailed in the \texttt{Help}
pane (use \texttt{?} in front of the function name).

\section{Change variable type}\label{change-variable-type}

Here are the main variable types in R:

\begin{longtable}[]{@{}ll@{}}
\caption{Example of each of variable type in
R.}\label{tbl-variable-type-example}\tabularnewline
\toprule\noalign{}
Variables & Examples \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
Variables & Examples \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Integer & 100, 77 \\
Numeric & 100.2, 77.8 \\
Character & ``hello'', ``ahmad'' \\
Logical & TRUE, FALSE \\
Factor & ``male'', ``female'' \\
Date & 9/7/2024, 9 July 2024 \\
\end{longtable}

The most common types in data are numeric, factor, and date. When
importing data from software such as SPSS, STATA, or Excel, R may not
always recognise the correct types. Let's create a sample dataset and
explore handling these issues.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create a data frame with mixed{-}up variable types}
\NormalTok{data\_messed\_up }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{id =} \FunctionTok{as.character}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{),                }
  \AttributeTok{score =} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{, }\DecValTok{6}\NormalTok{)),    }
  \AttributeTok{gender =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Male"}\NormalTok{, }\StringTok{"Female"}\NormalTok{), }\AttributeTok{length.out =} \DecValTok{6}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# View the variable types}
\FunctionTok{str}\NormalTok{(data\_messed\_up)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   6 obs. of  3 variables:
 $ id    : chr  "1" "2" "3" "4" ...
 $ score : chr  "25" "90" "91" "69" ...
 $ gender: chr  "Male" "Female" "Male" "Female" ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# View the data}
\NormalTok{data\_messed\_up}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  id score gender
1  1    25   Male
2  2    90 Female
3  3    91   Male
4  4    69 Female
5  5    98   Male
6  6    57 Female
\end{verbatim}

We can see that \texttt{score} should be numeric and \texttt{gender} a
factor. To convert these types, use \texttt{as.numeric()} and
\texttt{as.factor()}. Let's create a copy of \texttt{data\_messed\_up}
for demonstration purposes.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data\_messed\_up2 }\OtherTok{\textless{}{-}}\NormalTok{ data\_messed\_up}
\end{Highlighting}
\end{Shaded}

Using base R functions, we can adjust the types:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Change score column to numeric}
\NormalTok{data\_messed\_up}\SpecialCharTok{$}\NormalTok{score }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(data\_messed\_up}\SpecialCharTok{$}\NormalTok{score)}

\CommentTok{\# Change gender column to factor}
\NormalTok{data\_messed\_up}\SpecialCharTok{$}\NormalTok{gender }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(data\_messed\_up}\SpecialCharTok{$}\NormalTok{gender)}

\CommentTok{\# View variable type}
\FunctionTok{str}\NormalTok{(data\_messed\_up)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   6 obs. of  3 variables:
 $ id    : chr  "1" "2" "3" "4" ...
 $ score : num  25 90 91 69 98 57
 $ gender: Factor w/ 2 levels "Female","Male": 2 1 2 1 2 1
\end{verbatim}

Using \texttt{tidyverse}, we can achieve the same result with
\texttt{mutate()}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Change variable types for score and gender}
\NormalTok{data\_messed\_up2 }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_messed\_up2 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{score =} \FunctionTok{as.numeric}\NormalTok{(score),}
         \AttributeTok{gender =} \FunctionTok{as.factor}\NormalTok{(gender))}

\CommentTok{\# View variable type}
\FunctionTok{str}\NormalTok{(data\_messed\_up2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   6 obs. of  3 variables:
 $ id    : chr  "1" "2" "3" "4" ...
 $ score : num  25 90 91 69 98 57
 $ gender: Factor w/ 2 levels "Female","Male": 2 1 2 1 2 1
\end{verbatim}

\subsection{Handling date}\label{handling-date}

Dates can be tricky. For date variables, the standard format is
\texttt{YYYY-MM-DD}. Using \texttt{lubridate}, we can work with various
date formats easily. Let's look at a few examples:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Using base R }
\NormalTok{date\_data }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(}\StringTok{"2024{-}11{-}30"}\NormalTok{)}
\FunctionTok{str}\NormalTok{(date\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 Date[1:1], format: "2024-11-30"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Using lubridate}
\NormalTok{date\_data2 }\OtherTok{\textless{}{-}} \FunctionTok{as\_date}\NormalTok{(}\StringTok{"2024{-}11{-}30"}\NormalTok{)}
\FunctionTok{str}\NormalTok{(date\_data2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 Date[1:1], format: "2024-11-30"
\end{verbatim}

For non-standard formats, use \texttt{lubridate} functions
\texttt{ymd()}, \texttt{dmy()}, and \texttt{mdy()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# DD{-}MM{-}YYYY}
\NormalTok{date\_data3 }\OtherTok{\textless{}{-}} \FunctionTok{dmy}\NormalTok{(}\StringTok{"30{-}11{-}2024"}\NormalTok{)}
\FunctionTok{str}\NormalTok{(date\_data3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 Date[1:1], format: "2024-11-30"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# MM{-}DD{-}YY}
\NormalTok{date\_data4 }\OtherTok{\textless{}{-}} \FunctionTok{mdy}\NormalTok{(}\StringTok{"11{-}30{-}2024"}\NormalTok{)}
\FunctionTok{str}\NormalTok{(date\_data4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 Date[1:1], format: "2024-11-30"
\end{verbatim}

Correctly formatted date variables allow for operations such as:

\begin{itemize}
\item
  Date calculation: adding days to a date.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{date\_data4 }\SpecialCharTok{+} \DecValTok{7} 
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "2024-12-07"
\end{verbatim}
\item
  Extracting date components usch as month and year.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extract month}
\FunctionTok{month}\NormalTok{(date\_data4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 11
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Extract year}
\FunctionTok{year}\NormalTok{(date\_data4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2024
\end{verbatim}
\end{itemize}

To demonstrate dates in a dataset, we'll recreate
\texttt{data\_messed\_up} with a date column.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create a data frame with mixed{-}up variable types}
\NormalTok{data\_messed\_up }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{id =} \FunctionTok{as.character}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{),                }
  \AttributeTok{score =} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{, }\DecValTok{6}\NormalTok{)),    }
  \AttributeTok{gender =} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"Male"}\NormalTok{, }\StringTok{"Female"}\NormalTok{), }\AttributeTok{length.out =} \DecValTok{6}\NormalTok{),}
  \AttributeTok{date =} \FunctionTok{as.character}\NormalTok{(}\FunctionTok{Sys.Date}\NormalTok{() }\SpecialCharTok{{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# View variable type}
\FunctionTok{str}\NormalTok{(data\_messed\_up)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   6 obs. of  4 variables:
 $ id    : chr  "1" "2" "3" "4" ...
 $ score : chr  "92" "9" "93" "72" ...
 $ gender: chr  "Male" "Female" "Male" "Female" ...
 $ date  : chr  "2025-11-22" "2025-11-21" "2025-11-20" "2025-11-19" ...
\end{verbatim}

The \texttt{date} column is recognised as a character. To convert
\texttt{date} to a date format, use \texttt{as\_date()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Change variable types for score, gender, and date}
\NormalTok{data\_messed\_up }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_messed\_up }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{score =} \FunctionTok{as.numeric}\NormalTok{(score),}
         \AttributeTok{gender =} \FunctionTok{as.factor}\NormalTok{(gender),}
         \AttributeTok{date =} \FunctionTok{as\_date}\NormalTok{(date))}

\CommentTok{\# View variable type}
\FunctionTok{str}\NormalTok{(data\_messed\_up)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   6 obs. of  4 variables:
 $ id    : chr  "1" "2" "3" "4" ...
 $ score : num  92 9 93 72 26 7
 $ gender: Factor w/ 2 levels "Female","Male": 2 1 2 1 2 1
 $ date  : Date, format: "2025-11-22" "2025-11-21" ...
\end{verbatim}

The simplest solution for the date issue is to make sure we properly
input the date according to the right format (\texttt{YYYY-MM-DD})
during the data collection process properly.

\section{Merge datasets}\label{merge-datasets}

If you collect data from different sources, you may need to combine
datasets by row or column. \texttt{rbind()} combines datasets by row,
while \texttt{cbind()} combines them by column.

Let us see how to combine two iris datasets.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Data collected from area A}
\NormalTok{data1 }\OtherTok{\textless{}{-}}\NormalTok{ iris}

\CommentTok{\# Data collected from area B}
\NormalTok{data2 }\OtherTok{\textless{}{-}}\NormalTok{ iris}

\CommentTok{\# Combine both datasets by a row}
\NormalTok{data\_combined\_row }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(data1, data2)}
\end{Highlighting}
\end{Shaded}

Now, we can check the dimensions of the data. The first element
represents a row and the second element represents the column.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dimension of data1}
\FunctionTok{dim}\NormalTok{(data1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 150   5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dimension of data2}
\FunctionTok{dim}\NormalTok{(data2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 150   5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dimension of the combined data}
\FunctionTok{dim}\NormalTok{(data\_combined\_row)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 300   5
\end{verbatim}

We can see that the rows of \texttt{data1} and \texttt{data2} each are
150. Combining both data by a row gives us 300 rows. It is to be noted
that to use \texttt{rbind()}, both data should have the same column
numbers and names. Additionally, \texttt{rbind()} is not limited to two
data only.

Next, let us see the \texttt{cbind()}. Using the same data, we can
combine both data by a column.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Combine both datasets by a column}
\NormalTok{data\_combined\_col }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(data1, data2)}
\end{Highlighting}
\end{Shaded}

Thus, by further checking the dimension, we can see that the total
column of \texttt{data\_combined\_col} is 10, which is the sum of 5
columns in each of the \texttt{data1} and \texttt{data2}, while the row
remained the same.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dimension of data1}
\FunctionTok{dim}\NormalTok{(data1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 150   5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dimension of data2}
\FunctionTok{dim}\NormalTok{(data2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 150   5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dimension of the combined data}
\FunctionTok{dim}\NormalTok{(data\_combined\_col)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 150  10
\end{verbatim}

However, similar to \texttt{rbind()}, to use the \texttt{cbind()}, the
rows of both data should be identical. If participant A is in the first
row of \texttt{data1}, the, in \texttt{data2}, participant A should also
be in the first row.

There is another set of functions that is more efficient than
\texttt{cbind()}, in which we can combine two or more datasets according
to the id. Let us create two datasets that are related and have the same
ID.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Create the first half of the data}
\NormalTok{data\_half1 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"Ahmad"}\NormalTok{, }\StringTok{"Ali"}\NormalTok{, }\StringTok{"Cheng"}\NormalTok{, }\StringTok{"Rama"}\NormalTok{, }\StringTok{"Wei"}\NormalTok{),}
  \AttributeTok{height\_cm =} \FunctionTok{sample}\NormalTok{(}\DecValTok{160}\SpecialCharTok{:}\DecValTok{180}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# Create the second half of the data}
\NormalTok{data\_half2 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"Ahmad"}\NormalTok{, }\StringTok{"Ali"}\NormalTok{, }\StringTok{"Cheng"}\NormalTok{, }\StringTok{"Rama"}\NormalTok{, }\StringTok{"Karim"}\NormalTok{),}
  \AttributeTok{weight\_kg =} \FunctionTok{sample}\NormalTok{(}\DecValTok{70}\SpecialCharTok{:}\DecValTok{90}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# The first dataset}
\NormalTok{data\_half1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   name height_cm
1 Ahmad       174
2   Ali       178
3 Cheng       173
4  Rama       162
5   Wei       169
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The second dataset}
\NormalTok{data\_half2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   name weight_kg
1 Ahmad        87
2   Ali        80
3 Cheng        74
4  Rama        83
5 Karim        88
\end{verbatim}

Notice that the last row of both datasets is not similar. To combine
both datasets, we can use either \texttt{left\_join()} or
\texttt{right\_join()}. Both produce the same result. If there is a
mismatch between the two datasets, \texttt{left\_join()} will keep the
first dataset as a reference, and any of the id of the second dataset
that does not match the first one will be removed.
\texttt{right\_join()} works similar to the \texttt{left\_join()} but in
the opposite.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Combine the data}
\NormalTok{data\_full\_left }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_half1 }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\#first datasets}
  \FunctionTok{left\_join}\NormalTok{(data\_half2, }\AttributeTok{by =} \StringTok{"name"}\NormalTok{) }\CommentTok{\#second datasets}

\CommentTok{\# View the combined data}
\NormalTok{data\_full\_left}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   name height_cm weight_kg
1 Ahmad       174        87
2   Ali       178        80
3 Cheng       173        74
4  Rama       162        83
5   Wei       169        NA
\end{verbatim}

We can see that \texttt{karim} in the second dataset is excluded. Let's
see what will happen if we use \texttt{right\_join()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Combine the data}
\NormalTok{data\_full\_right }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_half1 }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\#first datasets}
  \FunctionTok{right\_join}\NormalTok{(data\_half2, }\AttributeTok{by =} \StringTok{"name"}\NormalTok{) }\CommentTok{\#second datasets}

\CommentTok{\# View the combined data}
\NormalTok{data\_full\_right}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   name height_cm weight_kg
1 Ahmad       174        87
2   Ali       178        80
3 Cheng       173        74
4  Rama       162        83
5 Karim        NA        88
\end{verbatim}

We can see that \texttt{Wei} in the first dataset is excluded. To
include all the participants, despite the mismatch of the id is by using
\texttt{full\_join()}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Combine the data}
\NormalTok{data\_full }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_half1 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{full\_join}\NormalTok{(data\_half2, }\AttributeTok{by =} \StringTok{"name"}\NormalTok{) }

\CommentTok{\# View the combined data}
\NormalTok{data\_full}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   name height_cm weight_kg
1 Ahmad       174        87
2   Ali       178        80
3 Cheng       173        74
4  Rama       162        83
5   Wei       169        NA
6 Karim        NA        88
\end{verbatim}

Both \texttt{Wei} and \texttt{Karim} are kept in the combined dataset.
Additionally, there is \texttt{inner\_join()}, which will exclude both
\texttt{Wei} and \texttt{Karim}. This function keeps the data that the
\texttt{name} is present in both datasets only.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Combine the data}
\NormalTok{data\_full\_inner }\OtherTok{\textless{}{-}} 
\NormalTok{  data\_half1 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{inner\_join}\NormalTok{(data\_half2, }\AttributeTok{by =} \StringTok{"name"}\NormalTok{) }

\CommentTok{\# View the combined data}
\NormalTok{data\_full\_inner}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   name height_cm weight_kg
1 Ahmad       174        87
2   Ali       178        80
3 Cheng       173        74
4  Rama       162        83
\end{verbatim}

\section{Chapter summary}\label{chapter-summary-4}

In this chapter, we covered the most common and basic operations in data
wrangling. More operations were not covered in this chapter as this book
is intended for beginners.

To summarise, we have covered:

\begin{itemize}
\tightlist
\item
  How to select a column and a row
\item
  How to filter a dataset based on a condition applied to columns
\item
  How to rename and create a column
\item
  How to manage variable types
\item
  How to combine several datasets into one
\end{itemize}

\section{Revision}\label{revision-4}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Load \texttt{mtcars} dataset in R.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(mtcars)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
\end{verbatim}
\item
  Read about\texttt{mtcars}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?mtcars}
\end{Highlighting}
\end{Shaded}
\item
  How many cars have \texttt{mpg} \textgreater{} 25?
\item
  How many cars have \texttt{mpg} \textgreater{} 25 and a number of
  carburetors of 2?
\item
  How many cars have a V-shaped engine?
\item
  Change \texttt{vs} and \texttt{am} into a factor.
\item
  Change the wide format data below into a long or tidy format.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)  }

\CommentTok{\# Create a wide format data}
\NormalTok{data\_wide }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{id =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{,}
  \AttributeTok{time1 =} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{time2 =} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{time3 =} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{), }
  \AttributeTok{age =} \FunctionTok{sample}\NormalTok{(}\DecValTok{18}\SpecialCharTok{:}\DecValTok{80}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}

\CommentTok{\# View the data frame}
\FunctionTok{head}\NormalTok{(data\_wide)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  id time1 time2 time3 age
1  1    31    90    26  32
2  2    79    91     7  49
3  3    51    69    42  59
4  4    14    91     9  62
5  5    67    57    83  24
6  6    42    92    36  26
\end{verbatim}

  The result of the long format data should appear like this.

  \begin{longtable}[]{@{}cccc@{}}
  \toprule\noalign{}
  id & age & time\_points & time\_minute \\
  \midrule\noalign{}
  \endhead
  \bottomrule\noalign{}
  \endlastfoot
  1 & 32 & time1 & 31 \\
  1 & 32 & time2 & 90 \\
  1 & 32 & time3 & 26 \\
  2 & 49 & time1 & 79 \\
  2 & 49 & time2 & 91 \\
  2 & 49 & time3 & 7 \\
  3 & 59 & time1 & 51 \\
  3 & 59 & time2 & 69 \\
  3 & 59 & time3 & 42 \\
  4 & 62 & time1 & 14 \\
  4 & 62 & time2 & 91 \\
  4 & 62 & time3 & 9 \\
  5 & 24 & time1 & 67 \\
  5 & 24 & time2 & 57 \\
  5 & 24 & time3 & 83 \\
  6 & 26 & time1 & 42 \\
  6 & 26 & time2 & 92 \\
  6 & 26 & time3 & 36 \\
  7 & 58 & time1 & 50 \\
  7 & 58 & time2 & 9 \\
  7 & 58 & time3 & 78 \\
  8 & 27 & time1 & 43 \\
  8 & 27 & time2 & 93 \\
  8 & 27 & time3 & 81 \\
  9 & 40 & time1 & 14 \\
  9 & 40 & time2 & 99 \\
  9 & 40 & time3 & 43 \\
  10 & 44 & time1 & 25 \\
  10 & 44 & time2 & 72 \\
  10 & 44 & time3 & 76 \\
  \end{longtable}
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Data visualisation}\label{data-visualisation}

\begin{quote}
``The simple graph has brought more information to the data analyst's
mind than any other device.''

-- John Tukey
\end{quote}

Data visualization helps transform complex data sets into clear,
insightful visuals, such as charts, graphs, maps, and infographics, to
make it easier for people to understand, analyze, and interpret
patterns, trends, and relationships within the data. By presenting data
in a visual format, it allows users to quickly identify outliers and
underlying patterns that might not be apparent in raw data alone.

In R itself, there are built-in functions for plotting various plots.
Additionally, there are several packages available for plotting in R.
Commonly utilised packages include \texttt{ggplot2}, \texttt{plotly},
\texttt{lattice}, and \texttt{leaflet}. \texttt{ggplot2} and
\texttt{lattice} are commonly used for static plots, while packages such
as \texttt{plotly} and \texttt{leaflet} are more common for interactive
plots.

In this chapter, we going to cover how to create plots using base R and
\texttt{ggplot2}. We going to learn the six most basic and commonly used
plots in data analysis:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Barplot
\item
  Histogram
\item
  Boxplot
\item
  Violin plot
\item
  Scatter plot
\end{enumerate}

We going to focus more on the \texttt{ggplot2} and only cover the basics
for base R plotting. \texttt{ggplot2} is widely used for plotting and
visualisation in the R community (Wickham 2016).

\section{Load packages}\label{load-packages-1}

Please load a \texttt{tidyverse} package before proceeding to the next
section. We do not need to load the \texttt{ggplot2} package as it is
part of the \texttt{tidyverse} meta package.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{Data}\label{data}

In this chapter, we going to utilise \texttt{ChickWeight} a built-in
dataset in R. This dataset is about the effect of different diet
regimens on the weight of the chicks.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# More info about the ChickWeight data}
\NormalTok{?ChickWeight}
\FunctionTok{data}\NormalTok{(}\StringTok{"ChickWeight"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Let's create a new variable from the \texttt{Time} variable. In this
dataset, the weight of the chicks was weighted each day until 21 days.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\OtherTok{\textless{}{-}} 
\NormalTok{  ChickWeight }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Time\_group =} \FunctionTok{cut}\NormalTok{(Time, }\AttributeTok{breaks =} \DecValTok{3}\NormalTok{, }\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Period 1"}\NormalTok{, }\StringTok{"Period 2"}\NormalTok{, }\StringTok{"Period 3"}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

We can check the variables.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(chick\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Classes 'nfnGroupedData', 'nfGroupedData', 'groupedData' and 'data.frame':  578 obs. of  5 variables:
 $ weight    : num  42 51 59 64 76 93 106 125 149 171 ...
 $ Time      : num  0 2 4 6 8 10 12 14 16 18 ...
 $ Chick     : Ord.factor w/ 50 levels "18"<"16"<"15"<..: 15 15 15 15 15 15 15 15 15 15 ...
 $ Diet      : Factor w/ 4 levels "1","2","3","4": 1 1 1 1 1 1 1 1 1 1 ...
 $ Time_group: Factor w/ 3 levels "Period 1","Period 2",..: 1 1 1 1 2 2 2 2 3 3 ...
\end{verbatim}

The second data we going to use is \texttt{ToothGrowth}. The data is
about the effect of vitamin C on tooth growth in guinea pigs.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# More info about the data}
\NormalTok{?ToothGrowth}
\FunctionTok{data}\NormalTok{(}\StringTok{"ToothGrowth"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Let's create a new variable based variable \texttt{dose}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tooth\_data }\OtherTok{\textless{}{-}} 
\NormalTok{  ToothGrowth }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dose\_group =} \FunctionTok{case\_when}\NormalTok{(dose }\SpecialCharTok{==} \FloatTok{0.5} \SpecialCharTok{\textasciitilde{}} \StringTok{"low"}\NormalTok{,}
\NormalTok{                                dose }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{\textasciitilde{}} \StringTok{"intermediate"}\NormalTok{,}
                                \AttributeTok{.default =} \StringTok{"high"}\NormalTok{),}
         \AttributeTok{dose\_group =} \FunctionTok{as.factor}\NormalTok{(dose\_group))}
\end{Highlighting}
\end{Shaded}

Here, we use \texttt{case\_when()} to classify the dose into 3 groups:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  0.5 as low dose
\item
  1 as intermediate dose
\item
  2 as high dose
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dose variable}
\FunctionTok{table}\NormalTok{(tooth\_data}\SpecialCharTok{$}\NormalTok{dose)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

0.5   1   2 
 20  20  20 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Dose group variable}
\FunctionTok{table}\NormalTok{(tooth\_data}\SpecialCharTok{$}\NormalTok{dose\_group)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

        high intermediate          low 
          20           20           20 
\end{verbatim}

Then, we can check the variable types.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(tooth\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   60 obs. of  4 variables:
 $ len       : num  4.2 11.5 7.3 5.8 6.4 10 11.2 11.2 5.2 7 ...
 $ supp      : Factor w/ 2 levels "OJ","VC": 2 2 2 2 2 2 2 2 2 2 ...
 $ dose      : num  0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 0.5 ...
 $ dose_group: Factor w/ 3 levels "high","intermediate",..: 3 3 3 3 3 3 3 3 3 3 ...
\end{verbatim}

Lastly, the third data that we going to use in this chapter is the
\texttt{cars} dataset, another built-in dataset in R. The data is about
the speed of the cars and the distances taken by the cars to stop.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# More info about the data}
\NormalTok{?cars}
\FunctionTok{data}\NormalTok{(}\StringTok{"cars"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Next, we going to create a new variable, a type of car.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Create a new variable}
\NormalTok{cars\_data }\OtherTok{\textless{}{-}} 
\NormalTok{  cars }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{car =} \FunctionTok{sample}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{), }\AttributeTok{size =} \DecValTok{50}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
         \AttributeTok{car =} \FunctionTok{as.factor}\NormalTok{(car))}
\end{Highlighting}
\end{Shaded}

We can check the new variable by using \texttt{table()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{table}\NormalTok{(cars\_data}\SpecialCharTok{$}\NormalTok{car)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

 A  B  C 
16 15 19 
\end{verbatim}

Also, we need to check the variable type.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(cars\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'data.frame':   50 obs. of  3 variables:
 $ speed: num  4 4 7 7 8 9 10 10 10 11 ...
 $ dist : num  2 10 4 22 16 10 18 26 34 17 ...
 $ car  : Factor w/ 3 levels "A","B","C": 3 3 3 2 3 2 2 2 3 1 ...
\end{verbatim}

\section{Barplot}\label{barplot}

Barplot is utilised when a variable is categorical. Let's explore the
\texttt{ChickWeight} data. To use \texttt{barplot()}, the data should be
a matrix.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diet\_table }\OtherTok{\textless{}{-}} 
\NormalTok{  chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Diet) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{table}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

Next, we can plot the \texttt{Diet} information.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(diet\_table)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-14-1.pdf}}

Let's beautify the plot by setting up a colour, axis label and title.
The arguments needed for those are:

\begin{itemize}
\tightlist
\item
  \texttt{col}: specifies the colour.
\item
  \texttt{xlab}: name of the x-axis.
\item
  \texttt{ylab}: name of the y-axis.
\item
  \texttt{main}: the title of the barplot.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{barplot}\NormalTok{(diet\_table, }\AttributeTok{col =} \StringTok{"steelblue"}\NormalTok{, }
        \AttributeTok{xlab =} \StringTok{"Diet regimen"}\NormalTok{, }
        \AttributeTok{ylab =} \StringTok{"Number of chicks"}\NormalTok{, }
        \AttributeTok{main =} \StringTok{"Protein diet regimens received by the chicks"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-15-1.pdf}}

Now, let's do this in \texttt{ggplot2}. In \texttt{ggplot2}, the R codes
are stacked on one over another. \texttt{ggplot()} initialises a
\texttt{ggplot} object, and it sort of sets up the canvas for the plot.
This part is aaplies to all the plots in \texttt{ggplot2}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-16-1.pdf}}

Next, we specify what type of plots that we want. Here, by using
\texttt{geom\_bar()}, we can see that the x- and y-axis are labelled.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-17-1.pdf}}

Let's supply the data for the barplot. The \texttt{x} argument specifies
the column on the x-axis that we want to plot.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Diet)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-18-1.pdf}}

We can further beautify the plot by adding colour, labelling the axis,
putting a title, and changing the theme of the plot. The arguments
needed are:

\begin{itemize}
\tightlist
\item
  \texttt{fill}: specifies the colour.
\item
  \texttt{x}: name of the x-axis.
\item
  \texttt{y}: name of the y-axis.
\item
  \texttt{title}: the title of the barplot.
\item
  \texttt{theme\_bw()}: specify the theme of the barplot.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Diet)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Protein diet regimens received by the chicks"}\NormalTok{, }
       \AttributeTok{x =} \StringTok{"Diet regimen"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Number of chicks"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-19-1.pdf}}

We can further add another variable, \texttt{Time\_group}, that we
created earlier. We remove the \texttt{colour} argument and add these
arguments:

\begin{itemize}
\tightlist
\item
  \texttt{fill} in \texttt{ggplot()}: another group variable (must be a
  factor).
\item
  \texttt{position}: dodge position allows us to maintain the vertical
  position of the plot.
\item
  \texttt{fill} in \texttt{labs()}: the legend title.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Diet, }\AttributeTok{fill =}\NormalTok{ Time\_group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Protein diet regimens received by the chicks"}\NormalTok{, }
       \AttributeTok{x =} \StringTok{"Diet regimen"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Number of chicks"}\NormalTok{,}
       \AttributeTok{fill =} \StringTok{"Time period:"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-20-1.pdf}}

Additionally, we can do bar plot based on another numerical variable in
the data. For example, let's plot diet regiemn based on the
\texttt{weight}. Here, instead of \texttt{geom\_bar()}, we are going to
use \texttt{geom\_col()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Diet, }\AttributeTok{y =}\NormalTok{ weight)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{fill =} \StringTok{"steelblue"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Protein diet regimens based on the weight of chicks"}\NormalTok{, }
       \AttributeTok{x =} \StringTok{"Diet regimen"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Weight of chicks (gm)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-21-1.pdf}}

Also, we can add the third variable, \texttt{Time\_group}. However, we
need to specify \texttt{position\_dodge()} in \texttt{geom\_col()} to
let R knows we want it side by side.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Diet, }\AttributeTok{y =}\NormalTok{ weight, }\AttributeTok{fill =}\NormalTok{ Time\_group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_col}\NormalTok{(}\AttributeTok{position =} \FunctionTok{position\_dodge}\NormalTok{()) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Protein diet regimens based on the weight of chicks and time groups"}\NormalTok{, }
       \AttributeTok{x =} \StringTok{"Diet regimen"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Weight of chicks (gm)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-22-1.pdf}}

\section{Histogram}\label{histogram}

A histogram is used when a variable is numerical. It reflects the
frequency distribution of the data.

Let's do the histogram in base R.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(chick\_data}\SpecialCharTok{$}\NormalTok{weight)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-23-1.pdf}}

We can see that from the histogram, most chicks in our data weigh around
50-100 grams regardless of time and diet regimen. We can further
beautify the histogram by adding a colour, and naming the x-axis and the
title. The arguments are similar to the barplot previously.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hist}\NormalTok{(chick\_data}\SpecialCharTok{$}\NormalTok{weight,}
     \AttributeTok{xlab =} \StringTok{"Weight in grams"}\NormalTok{,}
     \AttributeTok{ylab =} \StringTok{"Frequency of the chicks"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Histogram of the weight of the chicks (grams)"}\NormalTok{,}
     \AttributeTok{col =} \StringTok{"lightgreen"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-24-1.pdf}}

Next, let's do the basic histogram in \texttt{ggplot2} using
\texttt{geom\_histogram()}. The \texttt{bins} specifies the number of
intervals used to group the data. By \texttt{bins\ =\ 50}, we divide the
data into 50 equally spaced intervals or bins.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ weight)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{50}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-25-1.pdf}}

We can add a colour, title, and axis labels, and change the theme.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ weight)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{50}\NormalTok{, }\AttributeTok{fill =} \StringTok{"lightgreen"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Histogram of the weight of the chicks (grams)"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Weight in grams"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency of the chicks"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-26-1.pdf}}

We can also add another variable (a factor variable). Let's say we want
to see the distribution of the chick's weight across different diet
regimens. However, instead of displaying all groups of diet regimens in
a single plot, we display it across different plots in rows.
\texttt{facet\_grid()} specifies which column to use to divide across
the rows.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chick\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ weight)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{20}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Histogram of the weight of the chicks (grams)"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Weight in grams"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Frequency of the chicks"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\AttributeTok{rows =} \FunctionTok{vars}\NormalTok{(Diet)) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-27-1.pdf}}

Here, we can see more clearly that the weight of the chicks in diet
regimen 1 is skewed to the left side, while the weight of the chicks in
diet regimen 4 is distributed more uniformly.

\section{Boxplot}\label{boxplot}

Boxplot is utilised when a variable is numerical. The main use of the
boxplot is to display the spread of the data and further identify
outliers and extreme values. Outliers are observations that lie far from
the majority of the data. An extreme value may not be an outlier, but an
outlier is always an extreme value.

Let's plot the boxplot using base R.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(tooth\_data}\SpecialCharTok{$}\NormalTok{len)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-28-1.pdf}}

We can further beautify the plot.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(tooth\_data}\SpecialCharTok{$}\NormalTok{len,}
        \AttributeTok{col =} \StringTok{"orange"}\NormalTok{,}
        \AttributeTok{main =} \StringTok{"Boxplot of the tooth length of the guinea pigs"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-29-1.pdf}}

Let's do a similar boxplot using \texttt{ggplot2}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tooth\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ len)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-30-1.pdf}}

To beautify the plot.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tooth\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ len)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{fill =} \StringTok{"orange"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Boxplot the tooth length of the guinea pigs"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Length of tooth"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-31-1.pdf}}

We can further divide the boxplots by \texttt{dose\_group}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tooth\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dose\_group, }\AttributeTok{y =}\NormalTok{ len)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{fill =} \StringTok{"orange"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Boxplot the tooth length of the guinea pigs"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Length of tooth"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Dose groups"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-32-1.pdf}}

We can see that we may have an outlier in a low-dose group.

\section{Violin plot}\label{violin-plot}

A violin plot allows us to visualise the distribution of the numeric
variable according to a factor variable. It is a combination of a
boxplot and a density plot. In contrast to the boxplot, the violin plot
needs two variables.

There is no function in base R to plot the violin plot. However, we can
use \texttt{ggplot2} to plot the violin plot.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tooth\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ len, }\AttributeTok{y =}\NormalTok{ dose\_group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-33-1.pdf}}

We can further beautify the plot.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tooth\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ len, }\AttributeTok{y =}\NormalTok{ dose\_group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{fill =} \StringTok{"pink"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Violin plot of the tooth length based on the dose group"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Dose group"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Length of the tooth"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-34-1.pdf}}

We can further add the boxplot on top of the violin plot.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tooth\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ len, }\AttributeTok{y =}\NormalTok{ dose\_group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{fill =} \StringTok{"pink"}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.4}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.1}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Violin plot of the tooth length based on the dose group"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Dose group"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Length of the tooth"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-35-1.pdf}}

The argument \texttt{width} specifies the width of the boxplot and
\texttt{alpha} specifies the colour density.

\section{Scatter plot}\label{scatter-plot}

Scatter plots allow us to plot two continuous variables.

Let's plot a scatter plot using base R. We going to use the last
dataset, \texttt{cars\_data}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cars\_data}\SpecialCharTok{$}\NormalTok{speed, }\AttributeTok{y =}\NormalTok{ cars\_data}\SpecialCharTok{$}\NormalTok{dist)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-36-1.pdf}}

We can see that as the speed increases, the distance taken to stop also
increases. Next, to beautify the plot, we name the axis and title, and
specify a colour.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cars\_data}\SpecialCharTok{$}\NormalTok{speed, }
     \AttributeTok{y =}\NormalTok{ cars\_data}\SpecialCharTok{$}\NormalTok{dist,}
     \AttributeTok{col =} \StringTok{"red"}\NormalTok{,}
     \AttributeTok{main =} \StringTok{"Speed vs. stopping distance"}\NormalTok{,}
     \AttributeTok{ylab =} \StringTok{"Speed (Mile/hour)"}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{"Stopping distance (ft)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-37-1.pdf}}

Now, let's do the plot using \texttt{ggplot2}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cars\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dist, }\AttributeTok{y =}\NormalTok{ speed)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-38-1.pdf}}

Similarly to the plot in base R, we can further beautify the scatter
plot.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cars\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dist, }\AttributeTok{y =}\NormalTok{ speed)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{colour =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Speed vs. stopping distance"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Speed (Mile/hour)"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Stopping distance (ft)"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-39-1.pdf}}

Lastly, we further add another variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cars\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dist, }\AttributeTok{y =}\NormalTok{ speed, }\AttributeTok{colour =}\NormalTok{ car)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Speed vs. stopping distance"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Speed (Mile/hour)"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Stopping distance (ft)"}\NormalTok{,}
       \AttributeTok{colour =} \StringTok{"Type of car:"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-40-1.pdf}}

\section{Chapter summary}\label{chapter-summary-5}

In this chapter, we have learned about five different plots.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.0949}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3038}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.5949}}@{}}
\caption{Commonly used plots in data
analysis.}\label{tbl-common-plots}\tabularnewline
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Plots
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Variables
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Application
\end{minipage} \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Plots
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Variables
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Application
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Barplot & 1 factor variable & Display the proportion of a factor
variable \\
Histogram & 1 numerical variable &
\begin{minipage}[t]{\linewidth}\raggedright
\begin{itemize}
\tightlist
\item
  Display the frequency distribution of a numerical variable
\item
  Identify the pattern of the data (skewed or normally distributed)
\end{itemize}
\end{minipage} \\
Boxplot & 1 numerical variable &
\begin{minipage}[t]{\linewidth}\raggedright
\begin{itemize}
\tightlist
\item
  Display the spread of distribution of a numerical variable
\item
  Identify extreme values and outliers
\end{itemize}
\end{minipage} \\
Violin plot & 1 numerical variable vs.~1 factor variable & Display the
frequency distribution of a numerical variable based on another factor
variable \\
Scatter plot & 1 numerical variable vs.~1 numerical variable & Display a
relationship between two numerical variables \\
\end{longtable}

\section{Revision}\label{revision-5}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Load and read about \texttt{mtcars} dataset from base R.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the data}
\FunctionTok{data}\NormalTok{(}\StringTok{"mtcars"}\NormalTok{)}

\CommentTok{\# Read about the data}
\NormalTok{?mtcars}
\end{Highlighting}
\end{Shaded}

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \item
    Create a histogram using base R for the \texttt{mpg} variable using
    base R. The plot should look like the one below.

    \pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-42-1.pdf}}
  \item
    Create a boxplot for the \texttt{wt} variable using base R. The plot
    should look like the one below.

    \pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-43-1.pdf}}
  \item
    Create a scatter plot for \texttt{mpg} vs.~\texttt{wt} variables
    using base R. The plot should look like the one below.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(mtcars}\SpecialCharTok{$}\NormalTok{mpg, mtcars}\SpecialCharTok{$}\NormalTok{wt, }
     \AttributeTok{col =} \StringTok{"purple"}\NormalTok{, }
     \AttributeTok{main =} \StringTok{"Weight vs. miles per gallon"}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{"Mile per gallon"}\NormalTok{,}
     \AttributeTok{ylab =} \StringTok{"Weight (1000 lbs)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

    \pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-44-1.pdf}}
  \end{enumerate}
\item
  Load and read about \texttt{diamonds} data from the \texttt{ggplot2}
  package.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the packages}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\# Load the data}
\FunctionTok{data}\NormalTok{(}\StringTok{"diamonds"}\NormalTok{)}

\CommentTok{\# Read about the data}
\NormalTok{?diamonds}
\end{Highlighting}
\end{Shaded}

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \item
    Create a barplot of the \texttt{color} variable using
    \texttt{ggplot2}. The plot should look like the one below.

    \pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-46-1.pdf}}
  \item
    Create a scatter plot between \texttt{carat} and \texttt{price}
    using \texttt{ggplot2}. The plot should look like the one below.

    \pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-47-1.pdf}}
  \item
    Create a violin plot between \texttt{price} and \texttt{color} and
    further separate it by \texttt{cut} The plot should look like this.

    \pandocbounded{\includegraphics[keepaspectratio]{plotting_files/figure-pdf/unnamed-chunk-48-1.pdf}}
  \end{enumerate}
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Efficient coding}\label{efficient-coding}

\begin{quote}
``I think you can have a ridiculously enormous and complex data set, but
if you have the right tools and methodology, then it's not a problem.''

-- Aaron Koblin
\end{quote}

This chapter covers how to write a clear, concise, and optimised code to
handle data and computations effectively in R. We going to cover what is
a loop, how to make a function, and how to use an apply family function.
For beginners, this chapter will be quite challenging. So, it is
completely understandable if you need to read this chapter several
times. In fact, you are free to skip this chapter for the time being,
and come back again once you become more familiar with R.

Mastering the topics such as a loop, apply family and functions is
crucial especially once you become more advanced in using R. More often
than not, you will have a large data and you need to repeat the analysis
several times, thus, knowing these topics, makes the R codes more
efficient and concise (though not completely readable to beginners).

This chapter does not aim to cover everything on these topics. However,
this chapter intends to provide a brief introduction to these topics for
beginners and novices in R.

\section{Load packages}\label{load-packages-2}

Please load a \texttt{tidyverse} package before moving to the next
section.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{Loop}\label{loop}

A loop is utilised in the case of an iterative process. Generally, there
are two types of loops:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  For loop
\item
  While loop
\end{enumerate}

A for loop iterate iterates over a sequence. The general structure of
the for loop is:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (variable }\ControlFlowTok{in}\NormalTok{ sequence) \{}
    \CommentTok{\# Code to execute}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

For example, if we want to add 1 over a sequence of numbers:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Number sequence 1 to 10}
\NormalTok{num\_seq }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\NormalTok{num\_seq}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]  1  2  3  4  5  6  7  8  9 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make a for loop that adds 1 to each number in the sequence}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ num\_seq) \{}
\NormalTok{  i }\OtherTok{=}\NormalTok{ i }\SpecialCharTok{+} \DecValTok{1}
  \FunctionTok{print}\NormalTok{(i)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2
[1] 3
[1] 4
[1] 5
[1] 6
[1] 7
[1] 8
[1] 9
[1] 10
[1] 11
\end{verbatim}

\texttt{i} reflects each number in the number sequence, while
\texttt{print()} will print each number after 1 is added.

Now, let's try something more related to the data analysis. We going to
use the \texttt{iris} dataset for this example. For those who might not
be familiar, the \texttt{iris} dataset, is a built-in dataset in R.
Further details can be read on the \texttt{Help} pane by typing
\texttt{?iris}.

We going to calculate the mean for each numeric column in the
\texttt{iris} dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Loop through numeric columns of the iris dataset}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(iris)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{]) \{}
  
    \CommentTok{\# Calculate the mean of the current column}
\NormalTok{    column\_mean }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(iris[[col]])}
    
    \CommentTok{\# Round the mean to 2 decimal points}
\NormalTok{    column\_mean }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(column\_mean, }\AttributeTok{digits =} \DecValTok{2}\NormalTok{)}
    
    \CommentTok{\# Print the column name and its mean}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Mean of"}\NormalTok{, col, }\StringTok{"is"}\NormalTok{, column\_mean))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Mean of Sepal.Length is 5.84"
[1] "Mean of Sepal.Width is 3.06"
[1] "Mean of Petal.Length is 3.76"
[1] "Mean of Petal.Width is 1.2"
\end{verbatim}

Additionally, we can use for loop to do several plots. For example, we
can plot a boxplot for each numeric column in the \texttt{iris} dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select numeric columns only from iris}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris[, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{]}

\CommentTok{\# Loop through numeric columns of the iris dataset}
\ControlFlowTok{for}\NormalTok{ (col\_name }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(df)) \{}
  
  \CommentTok{\# Create a boxplot}
  \FunctionTok{boxplot}\NormalTok{(df[[col\_name]], }
          \AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Boxplot of"}\NormalTok{, col\_name), }
          \AttributeTok{ylab =}\NormalTok{ col\_name)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-6-1.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-6-2.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-6-3.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-6-4.pdf}}

Thus, integrating a for loop in the data analysis code will make it more
efficient. Next, let's see what is a while loop.

The while loop executes a block of code as long as a specified condition
remains true. A general structure of the while loop is:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{while}\NormalTok{ (condition) \{}
    \CommentTok{\# Code to execute}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

As a basic example of the while loop, we can add 1 to the sequence of
numbers as long as the number is below 10.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialise the number}
\NormalTok{count }\OtherTok{\textless{}{-}} \DecValTok{0}

\CommentTok{\# A while loop that adds 1 to each number as long as the number is less than 10}
\ControlFlowTok{while}\NormalTok{ (count }\SpecialCharTok{\textless{}} \DecValTok{10}\NormalTok{) \{}
\NormalTok{  count }\OtherTok{\textless{}{-}}\NormalTok{ count }\SpecialCharTok{+} \DecValTok{1}
  \FunctionTok{print}\NormalTok{(count)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 1
[1] 2
[1] 3
[1] 4
[1] 5
[1] 6
[1] 7
[1] 8
[1] 9
[1] 10
\end{verbatim}

So, as long as the \texttt{count} is not equal to 10, the while loop
will keep adding 1 to the \texttt{count}. Next, let's try the while loop
which is more related to the data analysis. By using the \texttt{iris}
dataset, let's say we want to calculate the cumulative sum of
\texttt{Sepal.Length} until the sum exceeds 60.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialize variables}
\NormalTok{index }\OtherTok{\textless{}{-}} \DecValTok{1} \CommentTok{\#index for looping}
\NormalTok{cumulative\_sum }\OtherTok{\textless{}{-}} \DecValTok{0} \CommentTok{\#variable to hold the cumulative sum}

\CommentTok{\# While loop to calculate the cumulative sum}
\ControlFlowTok{while}\NormalTok{ (cumulative\_sum }\SpecialCharTok{\textless{}=} \DecValTok{60} \SpecialCharTok{\&\&}\NormalTok{ index }\SpecialCharTok{\textless{}=} \FunctionTok{nrow}\NormalTok{(iris)) \{    }
  
  \CommentTok{\# Calculate the cumulative sum starting with the 1st row}
\NormalTok{  cumulative\_sum }\OtherTok{\textless{}{-}}\NormalTok{ cumulative\_sum }\SpecialCharTok{+}\NormalTok{ iris}\SpecialCharTok{$}\NormalTok{Sepal.Length[index]}
  
  \CommentTok{\# Move to the next row}
\NormalTok{  index }\OtherTok{\textless{}{-}}\NormalTok{ index }\SpecialCharTok{+} \DecValTok{1}  
  
  \CommentTok{\# Display the result}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Row "}\NormalTok{, index }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{, }\StringTok{", Cumulative sum: "}\NormalTok{, cumulative\_sum))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Row 1, Cumulative sum: 5.1"
[1] "Row 2, Cumulative sum: 10"
[1] "Row 3, Cumulative sum: 14.7"
[1] "Row 4, Cumulative sum: 19.3"
[1] "Row 5, Cumulative sum: 24.3"
[1] "Row 6, Cumulative sum: 29.7"
[1] "Row 7, Cumulative sum: 34.3"
[1] "Row 8, Cumulative sum: 39.3"
[1] "Row 9, Cumulative sum: 43.7"
[1] "Row 10, Cumulative sum: 48.6"
[1] "Row 11, Cumulative sum: 54"
[1] "Row 12, Cumulative sum: 58.8"
[1] "Row 13, Cumulative sum: 63.6"
\end{verbatim}

The conditions in the while loop above are:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  The loop will run until the cumulative sum exceeds 60
\item
  Or the last row of the dataset is reached.
\end{enumerate}

The last line of the codes is just to print the result. For now, you do
not actually need to understand it.

Generally, the for loop is more popular and commonly used compared to
the while loop. However, knowing both loops, at least at the basic level
will definitely benefit you in future. Additionally, the loop functions
are not only available in R but in other programming software such as
Python, Julia, MATLAB and Stata.

\section{Apply}\label{apply}

The apply family function in R is utilised to apply a specific operation
over elements of data structures such as vectors, matrices, and data
frames. This function is relatively similar to the loop function.
However, in R, generally, the apply family functions are faster and more
efficient compared to the loop functions.

There are 7 types of apply family functions:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{apply()}: applies a function over rows or columns of a matrix
  or array.
\item
  \texttt{lapply()}: applies a function to each element of a vector,
  data frame or list and returns a list.
\item
  \texttt{sapply()}: similar to \texttt{lapply()} but tries to simplify
  the result (e.g., into a vector or matrix).
\item
  \texttt{vapply()}: similar to \texttt{sapply()}, but requires
  specifying the output type.
\item
  \texttt{mapply()}: multivariate version of \texttt{sapply()}, applying
  a function to multiple arguments.
\item
  \texttt{tapply()}: applies a function over subsets of a vector grouped
  by a factor.
\item
  \texttt{rapply()}: recursive version of \texttt{lapply()} for nested
  lists.
\end{enumerate}

We are not going to cover all the apply family functions in this book,
but we going to cover the top three apply family functions
(\texttt{apply()}, \texttt{lapply()}, \texttt{sapply()}).

\textbf{\texttt{apply()} function}

The \texttt{apply()} is used to apply the function over rows or columns.
The basic syntax is:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{apply}\NormalTok{(X, MARGIN, FUN, ...)}
\end{Highlighting}
\end{Shaded}

The basic arguments that we need to supply:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{X}: an array.
\item
  \texttt{MARGIN}: where the function should be applied, 1 is at row,
  and 2 is at column.
\item
  \texttt{FUN}: the function.
\end{enumerate}

Let's try applying this function to our iris dataset. Let's say we want
to calculate the mean for each numeric column in the dataset.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{apply}\NormalTok{(iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species), }\AttributeTok{MARGIN =} \DecValTok{2}\NormalTok{ , }\AttributeTok{FUN =}\NormalTok{ mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
    5.843333     3.057333     3.758000     1.199333 
\end{verbatim}

\texttt{MARGIN\ =\ 2} indicates we want the mean of columns. If we set
\texttt{MARGIN\ =\ 1} means that we want the mean of each row.

\textbf{\texttt{lapply()} function}

The \texttt{lapply()} applies a function to each element of a list and
returns a list. The basic syntax is:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{lapply}\NormalTok{(X, FUN)}
\end{Highlighting}
\end{Shaded}

Where:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{X}: a vector, data frame or a list.
\item
  \texttt{FUN}: the function.
\end{enumerate}

As an example of \texttt{lapply()}, we can find the mean of each column
and see the result is returned in a list format.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{lapply}\NormalTok{(iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species), }\AttributeTok{FUN =}\NormalTok{ mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$Sepal.Length
[1] 5.843333

$Sepal.Width
[1] 3.057333

$Petal.Length
[1] 3.758

$Petal.Width
[1] 1.199333
\end{verbatim}

\textbf{\texttt{sapply()} function}

The \texttt{sapply()} function is similar to the \texttt{lapply()}, but
it simplifies the result. The syntax is similar to the
\texttt{lapply()}.

Let's use the same example as in the \texttt{lapply()} section and see
how is the output is formatted.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sapply}\NormalTok{(iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species), }\AttributeTok{FUN =}\NormalTok{ mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
    5.843333     3.057333     3.758000     1.199333 
\end{verbatim}

The output is formatted in a more simplified, and in this case, the
output format is similar to the one in the \texttt{apply()} function
section.

So, we have seen three functions from the apply family functions. As the
example in the for loop, we can also use the apply family function to
plot several plots.

\subsection{\texorpdfstring{\texttt{purrr}}{purrr}}\label{purrr}

\texttt{purrr} package is part of \texttt{tidyverse}, which contains
many functions that are equivalent to base R apply family functions.

The equivalent of \texttt{lapply()} function is \texttt{map()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{map}\NormalTok{(iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species), }\AttributeTok{.f =}\NormalTok{ mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
$Sepal.Length
[1] 5.843333

$Sepal.Width
[1] 3.057333

$Petal.Length
[1] 3.758

$Petal.Width
[1] 1.199333
\end{verbatim}

There are many more functions in the \texttt{purrr} package that are
highly beneficial to learn. However, most of these functions are more
advanced and require a deeper understanding of R, which goes beyond what
is covered in this book. As such, they may not be suitable for beginners
and novices at this stage.

\section{Function}\label{sec-loop-function}

One of the flexibility in R is we can make our own function. Let's make
a basic function that adds two numbers.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{add\_num }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(number1, number2) \{}
\NormalTok{  result }\OtherTok{\textless{}{-}}\NormalTok{ number1 }\SpecialCharTok{+}\NormalTok{ number2}
  \FunctionTok{return}\NormalTok{(result)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Next, let's try the function.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{add\_num}\NormalTok{(}\AttributeTok{number1 =} \DecValTok{100}\NormalTok{, }\AttributeTok{number2 =} \DecValTok{200}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 300
\end{verbatim}

Let's upgrade our function, instead of adding the number, we going to
calculate the mean of the numbers.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{avg\_num }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x\_range) \{}
  
  \CommentTok{\# Sum of all elements in the vector}
\NormalTok{  sum\_x }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x\_range)  }
  
  \CommentTok{\# Determine the number of elements in the vector}
\NormalTok{  n }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(x\_range)  }
  
  \CommentTok{\# Calculate mean}
\NormalTok{  mean\_value }\OtherTok{\textless{}{-}}\NormalTok{ sum\_x }\SpecialCharTok{/}\NormalTok{ n  }
  
  \CommentTok{\# Return the mean}
  \FunctionTok{return}\NormalTok{(mean\_value)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Let's try our function using the \texttt{iris} dataset, and compare it
with the \texttt{mean()} in the base R.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Our function}
\FunctionTok{avg\_num}\NormalTok{(iris}\SpecialCharTok{$}\NormalTok{Sepal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.843333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Mean function in R}
\FunctionTok{mean}\NormalTok{(iris}\SpecialCharTok{$}\NormalTok{Sepal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.843333
\end{verbatim}

Additionally, we can also integrate the R functions in our own function.
Let's say we want to build a function that can return the value of mean,
standard deviation (SD), median, and interquartile range (IQR). Instead
of typing the function one by one every time we need it, we can create a
function that gives us the four statistical measures. So, it is more
efficient to create this function if we need to run it more than two
times. For those who are not familiar with these statistical measures,
you can just ignore them for now as we will cover it in the later
chapter.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary\_func }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x\_range) \{}
  
  \CommentTok{\# Calculate mean and standard deviation, then round the decimal points to 2}
\NormalTok{  mean\_val }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(x\_range) }\SpecialCharTok{|\textgreater{}} \FunctionTok{round}\NormalTok{(}\AttributeTok{digits =} \DecValTok{2}\NormalTok{)}
\NormalTok{  std\_val }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(x\_range) }\SpecialCharTok{|\textgreater{}} \FunctionTok{round}\NormalTok{(}\AttributeTok{digits =} \DecValTok{2}\NormalTok{)}
  
  \CommentTok{\# Calculate median and interquartile range, then round the decimal points to 2}
\NormalTok{  med\_val }\OtherTok{\textless{}{-}} \FunctionTok{median}\NormalTok{(x\_range) }\SpecialCharTok{|\textgreater{}} \FunctionTok{round}\NormalTok{(}\AttributeTok{digits =} \DecValTok{2}\NormalTok{)}
\NormalTok{  iqr\_val }\OtherTok{\textless{}{-}} \FunctionTok{IQR}\NormalTok{(x\_range) }\SpecialCharTok{|\textgreater{}} \FunctionTok{round}\NormalTok{(}\AttributeTok{digits =} \DecValTok{2}\NormalTok{)}
  
  \CommentTok{\# Display the result}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{c}\NormalTok{(}
    \StringTok{\textasciigrave{}}\AttributeTok{Mean (SD)}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{paste0}\NormalTok{(mean\_val, }\StringTok{" ("}\NormalTok{, std\_val, }\StringTok{")"}\NormalTok{),}
    \StringTok{\textasciigrave{}}\AttributeTok{Median (IQR)}\StringTok{\textasciigrave{}} \OtherTok{=} \FunctionTok{paste0}\NormalTok{(med\_val, }\StringTok{" ("}\NormalTok{, iqr\_val, }\StringTok{")"}\NormalTok{)}
\NormalTok{  ))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Now, we have the function ready. Let's test out on the iris dataset.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary\_func}\NormalTok{(iris}\SpecialCharTok{$}\NormalTok{Sepal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    Mean (SD)  Median (IQR) 
"5.84 (0.83)"   "5.8 (1.3)" 
\end{verbatim}

Perfect! Now, every time we want to calculate the mean, SD, median, and
IQR for any column, we can just call our function.

To be more efficient we can combine our function with loop or apply
family functions that we have learnt in the previous sections. Instead
of running \texttt{summary\_func()} one by one for each column in the
\texttt{iris} dataset, we integrate it in the for loop.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Loop through numeric columns of the iris dataset}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in} \FunctionTok{names}\NormalTok{(iris)[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{]) \{}
  
    \CommentTok{\# Calculate mean of the current column}
\NormalTok{    res }\OtherTok{\textless{}{-}} \FunctionTok{summary\_func}\NormalTok{(iris[[col]])}
    
    \CommentTok{\# Print the result}
    \FunctionTok{print}\NormalTok{(res)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    Mean (SD)  Median (IQR) 
"5.84 (0.83)"   "5.8 (1.3)" 
    Mean (SD)  Median (IQR) 
"3.06 (0.44)"     "3 (0.5)" 
    Mean (SD)  Median (IQR) 
"3.76 (1.77)"  "4.35 (3.5)" 
   Mean (SD) Median (IQR) 
"1.2 (0.76)"  "1.3 (1.5)" 
\end{verbatim}

In R, it is more efficient to use the apply family functions. Let's use
\texttt{sapply()} for this.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sapply}\NormalTok{(iris }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species), }\AttributeTok{FUN =}\NormalTok{ summary\_func)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
             Sepal.Length  Sepal.Width   Petal.Length  Petal.Width 
Mean (SD)    "5.84 (0.83)" "3.06 (0.44)" "3.76 (1.77)" "1.2 (0.76)"
Median (IQR) "5.8 (1.3)"   "3 (0.5)"     "4.35 (3.5)"  "1.3 (1.5)" 
\end{verbatim}

What we have learned just now, is known as named function. It is
probably the most commonly used function.

\subsection{Anonymous function}\label{anonymous-function}

There is another type of function in R, known as the anonymous function.
It is defined without a name and is often used temporarily.

For example, let's create an anonymous function that squares a number.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{function}\NormalTok{(x) \{ x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{ \}}
\end{Highlighting}
\end{Shaded}

So, to use this function, we need to type the whole function again. In
contrast, the named function can be called by the name of the function
to be reused.

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{function}\NormalTok{(x) \{ x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{ \}(}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

An example of a practical use of the anonymous function is to be used in
line with apply family functions. For example, if we want to square the
range of numeric values.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sapply}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x) x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
 [1]   1   4   9  16  25  36  49  64  81 100
\end{verbatim}

Another example of using anonymous functions with the apply family is to
generate multiple plots, similar to the example in the for loop section.
In this case, we will use \texttt{walk()}, which is the equivalent of
the apply family function available in \texttt{purrr} package. Let's
create a boxplot for each numeric column in the \texttt{iris} dataset
using \texttt{walk()} and anonymous function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select numeric columns only from iris}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris[, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{]}

\CommentTok{\# Create boxplots for each numeric column using walk}
\FunctionTok{walk}\NormalTok{(}\FunctionTok{names}\NormalTok{(df), }\ControlFlowTok{function}\NormalTok{(col\_name) \{}
  \FunctionTok{boxplot}\NormalTok{(df[[col\_name]], }
          \AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Boxplot of"}\NormalTok{, col\_name),}
          \AttributeTok{ylab =}\NormalTok{ col\_name,}
          \AttributeTok{col =} \StringTok{"skyblue"}\NormalTok{)}
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-27-1.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-27-2.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-27-3.pdf}}

\pandocbounded{\includegraphics[keepaspectratio]{efficient-coding_files/figure-pdf/unnamed-chunk-27-4.pdf}}

The function \texttt{function(col\_name)} defines an anonymous function
to process each column name in \texttt{names(df)}. Using \texttt{walk()}
allows us to generate multiple boxplots, as it executes the function for
its side effects without returning any output. In contrast, using
\texttt{lapply()} for this task would return additional information,
specifically the statistics for each boxplot, alongside creating the
plots.

To observe this difference, try running the code below on your machine
and compare the behaviour of \texttt{walk()} and \texttt{lapply()} in
this context.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Select numeric columns only from iris}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ iris[, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{]}

\CommentTok{\# Create boxplots for each numeric column using lapply}
\FunctionTok{lapply}\NormalTok{(}\FunctionTok{names}\NormalTok{(df), }\ControlFlowTok{function}\NormalTok{(col\_name) \{}
  \FunctionTok{boxplot}\NormalTok{(df[[col\_name]], }
          \AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Boxplot of"}\NormalTok{, col\_name),}
          \AttributeTok{ylab =}\NormalTok{ col\_name,}
          \AttributeTok{col =} \StringTok{"skyblue"}\NormalTok{)}
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\section{Chapter summary}\label{chapter-summary-6}

We have covered adequately about the loop, apply family, and function.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3333}}
  >{\raggedright\arraybackslash}p{(\linewidth - 4\tabcolsep) * \real{0.3333}}@{}}
\caption{Brief summary of loop, apply family, and
function.}\label{tbl-summary-loop-apply-function}\tabularnewline
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\textbf{Concept}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Brief Description}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{When to Use}
\end{minipage} \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\textbf{Concept}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{Brief Description}
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
\textbf{When to Use}
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\textbf{Loop} & Iterative control structures (e.g., \texttt{for},
\texttt{while}) used to repeat a block of code for a set number of
iterations or conditions. & When flexibility and customization are
needed for tasks that may not easily fit into vectorized operations. \\
\textbf{Apply Family} & A group of vectorized functions (\texttt{apply},
\texttt{lapply}, \texttt{sapply}, \texttt{mapply}, etc.) that simplify
applying functions to data structures. & When performing repetitive
operations over data (e.g., rows, columns, or lists) without writing
explicit loops. \\
\textbf{Function} & A reusable block of code that performs a specific
task. Functions can be named or anonymous (e.g.,
\texttt{function(x)\ x\^{}2}). & Use when you need modular, repeatable
tasks or computations that are applied across datasets. \\
\end{longtable}

For readers seeking a greater challenge, I recommend reading the
\href{https://r4ds.hadley.nz/}{second edition of \emph{R for Data
Science} book}, particularly
\href{https://r4ds.hadley.nz/functions}{Chapter 25} on functions and
\href{https://r4ds.hadley.nz/base-r}{Chapter 27} on loops and the apply
family (Wickham, etinkaya-Rundel, and Grolemund 2023). Additionally, I
suggest exploring \href{https://r4ds.had.co.nz/iteration.html}{Chapter
21} of the \href{https://r4ds.had.co.nz/index.html}{first edition of
\emph{R for Data Science}}, as it covers the loops and apply family more
extensively (Wickham and Grolemund 2017).

\section{Revision}\label{revision-6}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Using \texttt{USJudgeRatings} dataset, a built-in dataset in R, write
  a for loop that calculates the median for the first two columns and
  prints the result. Ensure the medians are rounded to two decimal
  places.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"USJudgeRatings"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Write a for loop that generates histograms for each numeric column in
  the \texttt{iris} dataset. Customize each histogram to include a title
  and an appropriate x-axis label.
\item
  Analyse the following code and explain why it does not produce the
  expected output. Correct the code to ensure it calculates the sum of
  the first 5 rows of the \texttt{Sepal.Width} column in the
  \texttt{iris} dataset:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{count }\OtherTok{\textless{}{-}} \DecValTok{0}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{) \{}
\NormalTok{    count }\OtherTok{=}\NormalTok{ count }\SpecialCharTok{+}\NormalTok{ iris}\SpecialCharTok{$}\NormalTok{Sepal.Width}
\NormalTok{\}}
\FunctionTok{print}\NormalTok{(count)}
\end{Highlighting}
\end{Shaded}
\item
  Review the following code and identify the issue:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{apply}\NormalTok{(iris, }\AttributeTok{MARGIN =} \DecValTok{1}\NormalTok{, }\AttributeTok{FUN =}\NormalTok{ mean)}
\end{Highlighting}
\end{Shaded}

  Why does this produce an error or unexpected output? Correct the code
  so it calculates the mean of all numeric columns for each row in the
  \texttt{iris} dataset.
\item
  Rewrite the following base R code using the equivalent \texttt{purrr}
  function:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the library}
\FunctionTok{library}\NormalTok{(dplyr)}

\CommentTok{\# Change the codes below to the equivalent purrr function}
\FunctionTok{lapply}\NormalTok{(iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species), mean)}
\end{Highlighting}
\end{Shaded}
\item
  What are the difference between \texttt{lapply()} and
  \texttt{sapply()}.
\item
  Using the \texttt{summary\_func()} function in
  Section~\ref{sec-loop-function}, calculate the statistical summaries
  (mean, SD, median, IQR) for all numeric columns in the
  \texttt{USJudgeRatings} dataset, a built-in dataset in R. Use the
  \texttt{sapply()} function and for loop implementation.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"USJudgeRatings"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Create a function called \texttt{multiply\_num} that takes two
  arguments and returns their product. Use this function to multiply 10
  and 20. The function should result an output as below.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{multiply\_num}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 200
\end{verbatim}
\item
  Modify the \texttt{avg\_num()} function in
  Section~\ref{sec-loop-function} to include an optional argument
  \texttt{round()} that rounds the mean to a specified number of decimal
  places. Test it with the \texttt{iris\$Sepal.Length} column, rounding
  to 3 decimal places. The function should result an output as below.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{avg\_num}\NormalTok{(iris}\SpecialCharTok{$}\NormalTok{Sepal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.843
\end{verbatim}
\item
  Write an anonymous function that takes a numeric vector and returns a
  vector of squared values only for numbers greater than 5. Test this
  using \texttt{sapply()} with a sequence from 1 to 10.
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Data exploration}\label{data-exploration}

\begin{quote}
``Data is like garbage. You'd better know what you are going to do with
it before you collect it.''

-- Mark Twain
\end{quote}

Data exploration, as the name suggests involves the process of exploring
the data to understand its structures, identifying underlying patterns,
and discovering its characteristics. This process is the first stage in
analysing the data and gaining insight from it. Doing data analysis
without data exploration is akin to going to war without a proper
strategy.

R provides numerous functions and packages that can help to explore the
data efficiently and systematically. Thus, this chapter intends to
introduce those functions and packages to readers adequately and further
equip the readers to do any data analysis.

\section{Missing data}\label{missing-data}

Missing data are recognised as \texttt{NA} in R. Let's use
\texttt{airquality} data, a built-in dataset in R to see how R
recognised missing values.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Data with missing data}
\FunctionTok{data}\NormalTok{(}\StringTok{"airquality"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

By using \texttt{summary()}, we can see that the first two columns have
missing values, recognised as \texttt{NA}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(airquality)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
     Ozone           Solar.R           Wind             Temp      
 Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :56.00  
 1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:72.00  
 Median : 31.50   Median :205.0   Median : 9.700   Median :79.00  
 Mean   : 42.13   Mean   :185.9   Mean   : 9.958   Mean   :77.88  
 3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00  
 Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00  
 NA's   :37       NA's   :7                                       
     Month            Day      
 Min.   :5.000   Min.   : 1.0  
 1st Qu.:6.000   1st Qu.: 8.0  
 Median :7.000   Median :16.0  
 Mean   :6.993   Mean   :15.8  
 3rd Qu.:8.000   3rd Qu.:23.0  
 Max.   :9.000   Max.   :31.0  
                               
\end{verbatim}

Another function to give a quick answer to whether we have available
data or not is \texttt{anyNA()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{anyNA}\NormalTok{(airquality)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] TRUE
\end{verbatim}

To get the count of missing values, we can use \texttt{is.na()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.na}\NormalTok{(airquality) }\SpecialCharTok{|\textgreater{}} \FunctionTok{table}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

FALSE  TRUE 
  874    44 
\end{verbatim}

\texttt{TRUE} is 44, which means that we have 44 missing values across
individual cells in our dataset. To drop the missing values, we can use
\texttt{complete.cases()}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make an index}
\NormalTok{na\_index }\OtherTok{\textless{}{-}} \FunctionTok{complete.cases}\NormalTok{(airquality)}

\CommentTok{\# Apply the index to drop the NA\textquotesingle{}s}
\NormalTok{airquality\_noNA }\OtherTok{\textless{}{-}}\NormalTok{ airquality[na\_index, ]}
\end{Highlighting}
\end{Shaded}

Alternatively, it is easier to use \texttt{na.omit()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airquality\_noNA2 }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(airquality)}
\end{Highlighting}
\end{Shaded}

Both, \texttt{complete.cases()} and \texttt{na.omit()} return an
identical output.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Drop NA\textquotesingle{}s using complete.cases()}
\FunctionTok{dim}\NormalTok{(airquality\_noNA)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 111   6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Drop NA\textquotesingle{}s using na.omit()}
\FunctionTok{dim}\NormalTok{(airquality\_noNA2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 111   6
\end{verbatim}

We may want to explore the data with missing values. Thus, we can use
\texttt{complete.cases()} plus \texttt{!} in our codes to isolate the
data with missing values.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Make an index}
\NormalTok{na\_index }\OtherTok{\textless{}{-}} \FunctionTok{complete.cases}\NormalTok{(airquality)}

\CommentTok{\# Apply the index to drop the NA\textquotesingle{}s}
\NormalTok{airquality\_NA\_only }\OtherTok{\textless{}{-}}\NormalTok{ airquality[}\SpecialCharTok{!}\NormalTok{na\_index, ]}

\CommentTok{\# Data with missing values}
\FunctionTok{dim}\NormalTok{(airquality\_NA\_only)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 42  6
\end{verbatim}

Notice that the \texttt{airquality\_NA\_only} returns 44 rows of data
with missing values, while using \texttt{is.na()} earlier we get 44
missing values. \texttt{airquality\_NA\_only} returns rows of data with
missing values. The missing values may exist in more than a single
column in the dataset. The \texttt{is.na()} function counts all the
missing values regardless of the position.

\section{Outliers}\label{outliers}

An outlier is a data point that lies significantly outside the range of
most other observations in a dataset. It is an extreme value, either
unusually high or low, that differs markedly from other data points.
Outliers can occur due to variability in the data, errors in
measurement, or experimental anomalies.

Since outliers may not be representative of the data and may distort
statistical measures such as mean and standard deviation, it is
important to identify them early during the data exploration stage.

There are two methods to identify outliers:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Interquartile range (IQR) method:

  The IQR method identifies outliers as data points lying below Q1  1.5
   IQR or above Q3 + 1.5  IQR , where Q1 and Q3 are the first and
  third quartiles, respectively. This is the method that applies in the
  boxplot.

  Let's use \texttt{airquality\_noNA} data to demonstrate:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{out\_bp }\OtherTok{\textless{}{-}} \FunctionTok{boxplot}\NormalTok{(airquality\_noNA}\SpecialCharTok{$}\NormalTok{Wind, }\AttributeTok{main =} \StringTok{"Outliers in the wind column"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-9-1.pdf}}

  To access the values of the outliers:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{out\_bp}\SpecialCharTok{$}\NormalTok{out}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 20.1 18.4 20.7
\end{verbatim}

  To see the rows with the outliers:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airquality\_noNA }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(Wind }\SpecialCharTok{==} \FunctionTok{c}\NormalTok{(}\FloatTok{20.1}\NormalTok{, }\FloatTok{18.4}\NormalTok{, }\FloatTok{20.7}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Ozone Solar.R Wind Temp Month Day
1     8      19 20.1   61     5   9
2     6      78 18.4   57     5  18
3    37     284 20.7   72     6  17
\end{verbatim}
\item
  Z-score method:

  This method standardizes data and identifies outliers as those with a
  z-score greater than a threshold (commonly 3 or -3). The z-score (also
  called a standard score) is a statistical measure that indicates how
  many standard deviations a data point is from the mean of the dataset.

  Basically, the z-score is a distribution which reflects our dataset
  and it shows how far each value is from the average. So, in this
  context, outliers are the values that are significantly far from the
  average.

  Now, let's focus on understanding how we can detect the outliers using
  this method.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create z{-}score for the data}
\NormalTok{z\_scores }\OtherTok{\textless{}{-}} \FunctionTok{scale}\NormalTok{(airquality\_noNA}\SpecialCharTok{$}\NormalTok{Wind)}

\CommentTok{\# How many outliers}
\FunctionTok{table}\NormalTok{(}\FunctionTok{abs}\NormalTok{(z\_scores) }\SpecialCharTok{\textgreater{}} \DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

FALSE  TRUE 
  110     1 
\end{verbatim}

  \texttt{TRUE} is 1, which means that we have a single outlier in our
  data. Let's see which value is the outlier.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airquality\_noNA}\SpecialCharTok{$}\NormalTok{Wind[}\FunctionTok{abs}\NormalTok{(z\_scores) }\SpecialCharTok{\textgreater{}} \DecValTok{3}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 20.7
\end{verbatim}

  To see the row with the outlier:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airquality\_noNA }\SpecialCharTok{|\textgreater{}} 
\NormalTok{  dplyr}\SpecialCharTok{::}\FunctionTok{filter}\NormalTok{(Wind }\SpecialCharTok{==} \FloatTok{20.7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Ozone Solar.R Wind Temp Month Day
1    37     284 20.7   72     6  17
\end{verbatim}
\end{enumerate}

There are other advanced methods to detect outliers. However, the basics
to understand those methods are beyond the scope of this book.

\section{Useful packages}\label{sec-data-explore-useful-packages}

In this section, we going to see several useful R packages to explore
the data. We are only going to cover the main functions of each package.

\subsection{skimr}\label{skimr}

The \texttt{skimr} package provides various helpful functions to do data
exploration. Firstly, we need to install \texttt{skimr}, and then load
the packages. We going to use the \texttt{dplyr} package together with
the \texttt{skimr} package.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Install the package}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"skimr"}\NormalTok{)}

\CommentTok{\# Load the necessary packages}
\FunctionTok{library}\NormalTok{(skimr)}
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

To explore the whole dataset, we can use \texttt{skim}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Let\textquotesingle{}s use the iris dataset}
\FunctionTok{data}\NormalTok{(}\StringTok{"iris"}\NormalTok{)}

\CommentTok{\# Use skim}
\FunctionTok{skim}\NormalTok{(iris)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\caption{Data summary}\tabularnewline
\toprule\noalign{}
\endfirsthead
\endhead
\bottomrule\noalign{}
\endlastfoot
Name & iris \\
Number of rows & 150 \\
Number of columns & 5 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Column type frequency: & \\
factor & 1 \\
numeric & 4 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Group variables & None \\
\end{longtable}

\textbf{Variable type: factor}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 10\tabcolsep) * \real{0.1728}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 10\tabcolsep) * \real{0.1235}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 10\tabcolsep) * \real{0.1728}}
  >{\raggedright\arraybackslash}p{(\linewidth - 10\tabcolsep) * \real{0.0988}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 10\tabcolsep) * \real{0.1111}}
  >{\raggedright\arraybackslash}p{(\linewidth - 10\tabcolsep) * \real{0.3210}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
ordered
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_unique
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
top\_counts
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Species & 0 & 1 & FALSE & 3 & set: 50, ver: 50, vir: 50 \\
\end{longtable}

\textbf{Variable type: numeric}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.1842}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.1316}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.1842}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0658}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0658}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0526}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0526}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0658}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0526}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0658}}
  >{\raggedright\arraybackslash}p{(\linewidth - 20\tabcolsep) * \real{0.0789}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
mean
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
sd
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p0
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p25
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p50
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p75
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p100
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
hist
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Sepal.Length & 0 & 1 & 5.84 & 0.83 & 4.3 & 5.1 & 5.80 & 6.4 & 7.9 &
 \\
Sepal.Width & 0 & 1 & 3.06 & 0.44 & 2.0 & 2.8 & 3.00 & 3.3 & 4.4 &
 \\
Petal.Length & 0 & 1 & 3.76 & 1.77 & 1.0 & 1.6 & 4.35 & 5.1 & 6.9 &
 \\
Petal.Width & 0 & 1 & 1.20 & 0.76 & 0.1 & 0.3 & 1.30 & 1.8 & 2.5 &
 \\
\end{longtable}

The \texttt{skim} function will return the basic statistics for our data
including the information on the missing values (\texttt{n\_missing} and
\texttt{complete\_rate}) and a histogram for the numerical variables.
Additionally, we can get the basic statistics based on a certain group.
For example, here we use \texttt{group\_by()}, then, we apply
\texttt{skim()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{skim}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}ll@{}}
\caption{Data summary}\tabularnewline
\toprule\noalign{}
\endfirsthead
\endhead
\bottomrule\noalign{}
\endlastfoot
Name & Piped data \\
Number of rows & 150 \\
Number of columns & 5 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Column type frequency: & \\
numeric & 4 \\
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ & \\
Group variables & Species \\
\end{longtable}

\textbf{Variable type: numeric}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.1573}}
  >{\raggedright\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.1236}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.1124}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.1573}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0562}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0562}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0449}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0562}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0562}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0562}}
  >{\raggedleft\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0562}}
  >{\raggedright\arraybackslash}p{(\linewidth - 22\tabcolsep) * \real{0.0674}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
skim\_variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Species
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
n\_missing
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
complete\_rate
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
mean
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
sd
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p0
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p25
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p50
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p75
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
p100
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
hist
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Sepal.Length & setosa & 0 & 1 & 5.01 & 0.35 & 4.3 & 4.80 & 5.00 & 5.20 &
5.8 &  \\
Sepal.Length & versicolor & 0 & 1 & 5.94 & 0.52 & 4.9 & 5.60 & 5.90 &
6.30 & 7.0 &  \\
Sepal.Length & virginica & 0 & 1 & 6.59 & 0.64 & 4.9 & 6.23 & 6.50 &
6.90 & 7.9 &  \\
Sepal.Width & setosa & 0 & 1 & 3.43 & 0.38 & 2.3 & 3.20 & 3.40 & 3.68 &
4.4 &  \\
Sepal.Width & versicolor & 0 & 1 & 2.77 & 0.31 & 2.0 & 2.52 & 2.80 &
3.00 & 3.4 &  \\
Sepal.Width & virginica & 0 & 1 & 2.97 & 0.32 & 2.2 & 2.80 & 3.00 & 3.18
& 3.8 &  \\
Petal.Length & setosa & 0 & 1 & 1.46 & 0.17 & 1.0 & 1.40 & 1.50 & 1.58 &
1.9 &  \\
Petal.Length & versicolor & 0 & 1 & 4.26 & 0.47 & 3.0 & 4.00 & 4.35 &
4.60 & 5.1 &  \\
Petal.Length & virginica & 0 & 1 & 5.55 & 0.55 & 4.5 & 5.10 & 5.55 &
5.88 & 6.9 &  \\
Petal.Width & setosa & 0 & 1 & 0.25 & 0.11 & 0.1 & 0.20 & 0.20 & 0.30 &
0.6 &  \\
Petal.Width & versicolor & 0 & 1 & 1.33 & 0.20 & 1.0 & 1.20 & 1.30 &
1.50 & 1.8 &  \\
Petal.Width & virginica & 0 & 1 & 2.03 & 0.27 & 1.4 & 1.80 & 2.00 & 2.30
& 2.5 &  \\
\end{longtable}

Readers interested in learning more about the \texttt{skimr} package can
explore its \href{https://docs.ropensci.org/skimr/}{comprehensive
documentation} for more details and examples.

\subsection{naniar}\label{naniar}

\texttt{naniar} package provides tidy ways to summarise, visualise, and
manipulate missing data. First, let's install and load the necessary
packages.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Install the package}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"naniar"}\NormalTok{)}

\CommentTok{\# Load the necessary packages}
\FunctionTok{library}\NormalTok{(naniar)}
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

Let's use the \texttt{oceanbuoys} data, a dataset from the
\texttt{naniar} package. First, let's summarise the missing data
according to a variable. Further detail on the dataset can be found by
running \texttt{?oceanbuoys} in the \texttt{Console}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the data}
\FunctionTok{data}\NormalTok{(}\StringTok{"oceanbuoys"}\NormalTok{)}

\CommentTok{\# Missing values summary based on variables}
\FunctionTok{miss\_var\_summary}\NormalTok{(oceanbuoys)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 8 x 3
  variable   n_miss pct_miss
  <chr>       <int>    <num>
1 humidity       93   12.6  
2 air_temp_c     81   11.0  
3 sea_temp_c      3    0.408
4 year            0    0    
5 latitude        0    0    
6 longitude       0    0    
7 wind_ew         0    0    
8 wind_ns         0    0    
\end{verbatim}

\texttt{n\_miss} is the number of missing values and \texttt{pct\_miss}
is the percentage of missing values. We can further group the missing
values according to a certain variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{oceanbuoys }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(year) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{miss\_var\_summary}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 14 x 4
# Groups:   year [2]
    year variable   n_miss pct_miss
   <dbl> <chr>       <int>    <num>
 1  1997 air_temp_c     77   20.9  
 2  1997 latitude        0    0    
 3  1997 longitude       0    0    
 4  1997 sea_temp_c      0    0    
 5  1997 humidity        0    0    
 6  1997 wind_ew         0    0    
 7  1997 wind_ns         0    0    
 8  1993 humidity       93   25.3  
 9  1993 air_temp_c      4    1.09 
10  1993 sea_temp_c      3    0.815
11  1993 latitude        0    0    
12  1993 longitude       0    0    
13  1993 wind_ew         0    0    
14  1993 wind_ns         0    0    
\end{verbatim}

\texttt{naniar} also provides a visual summary for missing values.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{gg\_miss\_var}\NormalTok{(oceanbuoys)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-23-1.pdf}}

We can further group by a variable using the \texttt{facet} argument.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{gg\_miss\_var}\NormalTok{(oceanbuoys, }\AttributeTok{facet =}\NormalTok{ year)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-24-1.pdf}}

The content we just covered provides only a glimpse of the powerful
features and capabilities of the \texttt{naniar} package. For a deeper
understanding and comprehensive insights, readers are encouraged to
explore the
\href{https://naniar.njtierney.com/index.html}{\texttt{naniar}
documentation website}.

\subsection{DataExplorer}\label{dataexplorer}

\texttt{DataExplorer} provides various helpful functions for data
exploration. First, let's install and load the necessary packages.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Install package}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"DataExplorer"}\NormalTok{)}

\CommentTok{\# Load the necessary packages}
\FunctionTok{library}\NormalTok{(DataExplorer)}
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

Let's use \texttt{oceanbuoys} data from the \texttt{naniar} package
previously.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the data }
\FunctionTok{data}\NormalTok{(}\StringTok{"oceanbuoys"}\NormalTok{, }\AttributeTok{package =} \StringTok{"naniar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{DataExplorer} provides a general function to explore the data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot\_intro}\NormalTok{(oceanbuoys)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-28-1.pdf}}

From the plot, we understand that our data consists of all continuous
(numeric) columns and no discrete (categorical) columns. No missing
columns but we have 3\% missing observations.

To investigate the missing observations, we can use
\texttt{plot\_missing()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot\_missing}\NormalTok{(oceanbuoys)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-29-1.pdf}}

Alternatively, we can get a summary instead of a plot.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{profile\_missing}\NormalTok{(oceanbuoys)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 8 x 3
  feature    num_missing pct_missing
  <fct>            <int>       <dbl>
1 year                 0     0      
2 latitude             0     0      
3 longitude            0     0      
4 sea_temp_c           3     0.00408
5 air_temp_c          81     0.110  
6 humidity            93     0.126  
7 wind_ew              0     0      
8 wind_ns              0     0      
\end{verbatim}

Additionally, \texttt{DataExplorer} provides a function to plot a
correlation matrix. Correlation is a measure of association between two
numerical variables. It ranges between -1 and 1. Values close to 1
indicate a high positive correlation between the two variables, while
values close to -1 indicate a high negative correlation between the two
numerical variables. Values close to 0 indicate a low correlation
between the two values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{oceanbuoys }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{na.omit}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{plot\_correlation}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-31-1.pdf}}

To do a correlation or in this case correlation plot, the variables
should be numerical and have no missing values (hence, the use of
\texttt{na.omit()} in the code). If for example, we want to apply this
function to the \texttt{iris} dataset, in which we know that one of the
variables is categorical, we need to exclude the variable first.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{plot\_correlation}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-32-1.pdf}}

Alternatively, the more efficient code to exclude the non-numerical
variable is using the \texttt{select\_if()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select\_if}\NormalTok{(is.numeric) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{plot\_correlation}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-33-1.pdf}}

\texttt{DataExplorer} provides more useful functions, which can not be
extensively covered in this section. Interested readers can further
study \href{https://boxuancui.github.io/DataExplorer/index.html}{its
documentation} for more.

\subsection{VIM}\label{vim}

The \texttt{VIM} package contains tools for the visualisation of missing
and/or imputed values. Imputation of the missing values is beyond the
scope of this book. However, we going to see how functions from the
\texttt{VIM} package can be utilised to explore the pattern of
missingness.

First, make sure to install the \texttt{VIM} package and load the
necessary packages.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Install package}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"VIM"}\NormalTok{)}

\CommentTok{\# Load the necessary packages}
\FunctionTok{library}\NormalTok{(VIM)}
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

Let's use \texttt{oceanbuoys} data from the \texttt{naniar} package
previously.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the data }
\FunctionTok{data}\NormalTok{(}\StringTok{"oceanbuoys"}\NormalTok{, }\AttributeTok{package =} \StringTok{"naniar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The \texttt{aggr()} function will plot our data and visualise the
pattern of missing values. \texttt{numbers\ =\ TRUE} and
\texttt{prop\ =\ FALSE} to make sure the number missing values in a
number not a proportion.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{aggr}\NormalTok{(oceanbuoys, }\AttributeTok{numbers =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{prop =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-37-1.pdf}}

The red colour represents the missing values, and the blue colour
represents the observed values. The first plot on the left presents the
proportion of missing values according to variables. The second plot on
the right presents the combination of missing values. Notice that if we
have too many variables, the variable names will not be fully displayed.
For example in the second plot, for a combination of
\texttt{sea\_temp\_c}, \texttt{air\_temp\_c}, and \texttt{humidity}, we
have 2 values missing.

The \texttt{aggr()} function is suitable to be utilised when we have a
small to intermediate number of variables. For data with a large number
of variables, \texttt{matrixplot()} may be more appropriate.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{matrixplot}\NormalTok{(oceanbuoys)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-38-1.pdf}}

\texttt{matrixplot()} scales the data into 0 (white) and 1 (black). The
higher values will become close to 1, and the lower values will become
close to 0. The red colour represents the missing values.

The \texttt{VIM} package contains more useful functions, however, the
majority of them are for exploring the imputation methods and values.
Interested readers can further study
\href{https://statistikat.github.io/VIM/index.html}{its documentation}
for more details.

\subsection{dlookr}\label{dlookr}

The \texttt{dlookr} package provides various helpful functions
especially related to outliers. First, we need to install the
\texttt{dlookr} package and load the necessary packages.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Install package}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"dlookr"}\NormalTok{)}

\CommentTok{\# Load the packages}
\FunctionTok{library}\NormalTok{(dlookr)}
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

Let's use the \texttt{Carseats} dataset, a dataset from \texttt{dlookr}
package. The \texttt{diagnose\_numeric()} function from the
\texttt{dlookr} package is particularly useful for diagnosing numeric
variables.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the data}
\FunctionTok{data}\NormalTok{(}\StringTok{"Carseats"}\NormalTok{)}

\CommentTok{\# Diagnose function}
\FunctionTok{diagnose\_numeric}\NormalTok{(Carseats)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    variables min     Q1       mean median     Q3    max zero minus outlier
1       Sales   0   5.39   7.496325   7.49   9.32  16.27    1     0       2
2   CompPrice  77 115.00 124.975000 125.00 135.00 175.00    0     0       2
3      Income  21  42.75  68.657500  69.00  91.00 120.00    0     0       0
4 Advertising   0   0.00   6.635000   5.00  12.00  29.00  144     0       0
5  Population  10 139.00 264.840000 272.00 398.50 509.00    0     0       0
6       Price  24 100.00 115.795000 117.00 131.00 191.00    0     0       5
7         Age  25  39.75  53.322500  54.50  66.00  80.00    0     0       0
8   Education  10  12.00  13.900000  14.00  16.00  18.00    0     0       0
\end{verbatim}

Among its results, it provides the following insights:

\begin{itemize}
\tightlist
\item
  \texttt{zero}: the number of zero values in the data.
\item
  \texttt{minus}: the count of negative values.
\item
  \texttt{outlier}: the number of potential outliers detected in the
  dataset.
\end{itemize}

Additionally, we have \texttt{diagnose\_category()} which summarises
categorical variables. This function returns several outputs:

\begin{itemize}
\tightlist
\item
  \texttt{levels}: level for each categorical variable.
\item
  \texttt{N}: number of observations.
\item
  \texttt{freq}: number of observations at the levels.
\item
  \texttt{ratio}: percentage of observations at the levels
\item
  \texttt{rank}: rank of occupancy ratio of levels
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diagnose\_category}\NormalTok{(Carseats)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  variables levels   N freq ratio rank
1 ShelveLoc Medium 400  219 54.75    1
2 ShelveLoc    Bad 400   96 24.00    2
3 ShelveLoc   Good 400   85 21.25    3
4     Urban    Yes 400  282 70.50    1
5     Urban     No 400  118 29.50    2
6        US    Yes 400  258 64.50    1
7        US     No 400  142 35.50    2
\end{verbatim}

We can further explore the outliers identified by
\texttt{diagnose\_numeric()} using \texttt{diagnose\_outlier()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diagnose\_outlier}\NormalTok{(Carseats)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    variables outliers_cnt outliers_ratio outliers_mean  with_mean without_mean
1       Sales            2           0.50         15.95   7.496325     7.453844
2   CompPrice            2           0.50        126.00 124.975000   124.969849
3      Income            0           0.00           NaN  68.657500    68.657500
4 Advertising            0           0.00           NaN   6.635000     6.635000
5  Population            0           0.00           NaN 264.840000   264.840000
6       Price            5           1.25        100.40 115.795000   115.989873
7         Age            0           0.00           NaN  53.322500    53.322500
8   Education            0           0.00           NaN  13.900000    13.900000
\end{verbatim}

This function returns:

\begin{itemize}
\tightlist
\item
  \texttt{outliers\_cnt}: number of outliers.
\item
  \texttt{outliers\_ratio}: percent of outliers.
\item
  \texttt{outliers\_mean}: mean of outliers.
\item
  \texttt{with\_mean}: mean of values with outliers.
\item
  \texttt{without\_mean}: mean of values of without outliers.
\end{itemize}

In fact, we can further simplify the result using the \texttt{filter()}
from the \texttt{dplyr} package.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{diagnose\_outlier}\NormalTok{(Carseats) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(outliers\_cnt }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  variables outliers_cnt outliers_ratio outliers_mean  with_mean without_mean
1     Sales            2           0.50         15.95   7.496325     7.453844
2 CompPrice            2           0.50        126.00 124.975000   124.969849
3     Price            5           1.25        100.40 115.795000   115.989873
\end{verbatim}

Furthermore, \texttt{dlookr} provides another useful function to
visualise the outliers. However, for this example, we going to select a
single variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Carseats }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Sales) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{plot\_outlier}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{data-explore_files/figure-pdf/unnamed-chunk-45-1.pdf}}

This function returns a boxplot and histogram for values with and
without outliers. Thus, we can see how much the outliers in the
variables change the distribution of the data. \texttt{dlookr} actually
provides more functions than the ones we covered in this section.
Readers are suggested to go through its
\href{https://choonghyunryu.github.io/dlookr/index.html}{documentation}
to further learn this package.

\section{Chapter summary}\label{chapter-summary-7}

In this chapter, we have covered how missing data and outliers were
identified in R using base R functions. Moreover, we have covered
several useful functions from five R packages:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  skimr
\item
  naniar
\item
  DataExplorer
\item
  VIM
\item
  dlookr
\end{enumerate}

\texttt{skimr} provides general functions for data exploration (Waring
et al. 2024). \texttt{naniar}, \texttt{DataExplorer}, and \texttt{VIM}
provide additional functions to explore and investigate missing data
(Tierney and Cook 2023; Cui 2024; Kowarik and Templ 2016). Lastly,
\texttt{dlookr} provides more functions for investigating outliers in
the dataset (Ryu 2024).

While this chapter highlights the capabilities of these five packages,
it is important to note that R offers many additional packages that can
further enhance your analysis. Readers are encouraged to explore beyond
these tools to find packages best suited to their specific needs.

\section{Revision}\label{revision-7}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Why is data exploration considered a crucial first step in data
  analysis, and what are some R functions and packages that can help in
  this process?
\item
  Write an R code to check for missing values in each column of the
  \texttt{riskfactors} dataset, a dataset from the \texttt{naniar}
  package. Then, count how many \texttt{NA} values exist in total.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the data}
\FunctionTok{data}\NormalTok{(}\StringTok{"riskfactors"}\NormalTok{, }\AttributeTok{package =} \StringTok{"naniar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  Using the \texttt{riskfactors} dataset from question 2, write R code
  to remove all missing values in the dataset and determine how many
  rows are left.
\item
  Besides dropping the missing values, what are the possible solutions
  to missing values?
\item
  What are the possible solutions for outliers?
\item
  What are the pros and cons of dropping:

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    Missing values
  \item
    Outliers
  \end{enumerate}
\item
  Name three packages for data exploration besides the five packages
  covered in this chapter.
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{Descriptive statistics}\label{descriptive-statistics}

\begin{quote}
``Descriptive statistics are not just numbers; they tell stories about
data.''

-- Anonymous
\end{quote}

Descriptive statistics, as the name suggests, involves summarizing and
describing the main features of a dataset. It allows us to distil large
or complex datasets into manageable summaries, making it easier to
interpret and understand the data. While some details are inevitably
lost during this process, we gain valuable insights and a clearer
direction for further analysis.

This statistical approach is crucial in data analysis because it
provides a foundation for understanding the overall structure of the
data. Descriptive statistics use measures such as central tendency
(mean, median, and mode), variability (range, variance, and standard
deviation), and data visualization tools (like histograms and pie
charts) to offer a clear overview of the data's characteristics.

By simplifying the data, descriptive statistics not only highlight
trends and patterns but also serve as a stepping stone for more advanced
statistical methods. In this chapter, we will cover the fundamentals of
descriptive statistics, helping you understand its key concepts,
techniques, and practical applications.

\section{Load packages}\label{load-packages-3}

Please load these packages before proceeding to the next section.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Install the packages if necessary}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"DescTools"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"summarytools"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"gtsummary"}\NormalTok{)}

\CommentTok{\# Load the packages}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{Measures of central
tendency}\label{measures-of-central-tendency}

Measures of central tendency aim to identify the centre or typical value
within a dataset. It provides a summary of the data by describing the
point around which most values cluster.

\subsection{Mean}\label{mean}

The mean represents the average of a dataset. It is calculated by
summing all the values in the dataset and dividing the total by the
number of values. \[
Mean(\overline{x}) = \frac{\sum x}{n}
\]

For example, to calculate the mean manually for the numbers:

\[
5, 6, 7, 8, 13, 2
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Sum up all the values (\(\Sigma x\)).

  \[
  5 + 6 + 7 + 8 + 13 + 2 = 41
  \]
\item
  Divide the sum of all the values by the count of the values (\(n\)).\\
  \[
  \frac{41}{6} = 6.83
  \]
\end{enumerate}

Alternatively, R provides a \texttt{mean()} function to calculate the
mean of values.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The values}
\NormalTok{x\_mean }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{2}\NormalTok{)}

\CommentTok{\# Calculate mean}
\FunctionTok{mean}\NormalTok{(x\_mean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6.833333
\end{verbatim}

\subsection{Median}\label{median}

The median represents the middle value in a sorted dataset. It divides
the dataset into two halves: 50\% of the data values are smaller than
the median, and 50\% are larger.

For example, to determine the median for the below values:

\[
5, 6, 7, 8, 13, 2
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Sort the values in order from the smallest to the largest.

  \[
  2, 5, 6, 7, 8, 13
  \]
\item
  Determine the middle values (if there are two middle values, calculate
  the average of the two values).

  \[
  \frac{6 + 7}{2} = 6.5
  \]
\end{enumerate}

Alternatively, to calculate the median in R, we can use the
\texttt{median()} function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The values}
\NormalTok{x\_med }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{2}\NormalTok{)}

\CommentTok{\# Calculate the median}
\FunctionTok{median}\NormalTok{(x\_med)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 6.5
\end{verbatim}

\subsection{Mode}\label{mode}

The mode represents the most frequently occurring value in a dataset. It
is the value that appears the most times. Unlike the mean or median, the
mode can be used for both numerical and categorical data.

For example, to determine the mode for the numbers:

\[
5, 6, 7, 8, 13, 2, 8, 1
\]

The mode is the most frequent value which is 8.

In R, there is no function in base R to determine the value of mode.
However, we can manually determine the its value in R.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Range of values}
\NormalTok{x\_mode\_num }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{13}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\CommentTok{\# Calculate the count for each value}
\NormalTok{x\_mode\_num\_table }\OtherTok{\textless{}{-}} 
\NormalTok{  x\_mode\_num }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{table}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as.data.frame}\NormalTok{()}
\NormalTok{x\_mode\_num\_table}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
   . Freq
1  1    1
2  2    1
3  5    1
4  6    1
5  7    1
6  8    2
7 13    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Determine the frequently appearing value}
\NormalTok{x\_mode\_num\_table }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Freq }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(Freq))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  . Freq
1 8    2
\end{verbatim}

Additionally, we can determine the mode for the categorical data using
the same approach:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Range of values}
\NormalTok{x\_mode\_cat }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"yes"}\NormalTok{, }\StringTok{"no"}\NormalTok{, }\StringTok{"unsure"}\NormalTok{, }\StringTok{"yes"}\NormalTok{, }\StringTok{"yes"}\NormalTok{, }\StringTok{"no"}\NormalTok{)}

\CommentTok{\# Calculate the count for each value}
\NormalTok{x\_mode\_cat\_table }\OtherTok{\textless{}{-}} 
\NormalTok{  x\_mode\_cat }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{table}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{as.data.frame}\NormalTok{()}
\NormalTok{x\_mode\_cat\_table}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
       . Freq
1     no    2
2 unsure    1
3    yes    3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Determine the frequently appearing value}
\NormalTok{x\_mode\_cat\_table }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Freq }\SpecialCharTok{==} \FunctionTok{max}\NormalTok{(Freq))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    . Freq
1 yes    3
\end{verbatim}

Alternatively, there are several packages available to determine the
mode. For example, we can use the \texttt{DescTools} package.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Determine the mode for numerical values}
\NormalTok{DescTools}\SpecialCharTok{::}\FunctionTok{Mode}\NormalTok{(x\_mode\_num)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 8
attr(,"freq")
[1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Determine the mode for categorical values}
\NormalTok{DescTools}\SpecialCharTok{::}\FunctionTok{Mode}\NormalTok{(x\_mode\_cat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "yes"
attr(,"freq")
[1] 3
\end{verbatim}

The \texttt{Mode()} function from \texttt{DescTools} returns the mode
value and the frequency of the values. For example, \texttt{yes} is the
mode and it appears in the data 3 times.

\subsection{Comparison of mean, median, and
mode}\label{comparison-of-mean-median-and-mode}

\subsubsection{Mean vs.~median}\label{mean-vs.-median}

The mean is sensitive to outliers compared to the median and mode. In
the presence of outliers, the median is more robust and thus, preferred
to describe the central tendency of the data. Let's demonstrate the
change of mean and median in the presence of the outliers.

Firstly, let's create the data with and without the outlier.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Create data}
\NormalTok{outlier\_data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{outlier =} \FunctionTok{c}\NormalTok{(}\FunctionTok{sample}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{), }\AttributeTok{size =} \DecValTok{20}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{), }\DecValTok{100}\NormalTok{),}
  \AttributeTok{normal =} \FunctionTok{sample}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{), }\AttributeTok{size =} \DecValTok{21}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Before we demonstrate further, let's change the data structure, so, that
it is easier to do the plots.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{outlier\_data\_long }\OtherTok{\textless{}{-}} 
\NormalTok{  outlier\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \CommentTok{\# Change data structure to long data}
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{names\_to =} \StringTok{"Variable"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"Value"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Let's plot the boxplot for both data to visualise the outlier.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{outlier\_data\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Value, }\AttributeTok{fill =}\NormalTok{ Variable)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Boxplot of variables with and without the outlier"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Value"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Frequency"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{descriptive-stat_files/figure-pdf/unnamed-chunk-10-1.pdf}}

We can see the outlier in the \texttt{var\_outlier}. If we plot the
histogram for both variables, we can further visualise the distribution
of the data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{outlier\_data\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Value, }\AttributeTok{fill =}\NormalTok{ Variable)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{bins =} \DecValTok{50}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\AttributeTok{rows =} \FunctionTok{vars}\NormalTok{(Variable)) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Histogram of variables with and without the outlier"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Value"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Frequency"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{descriptive-stat_files/figure-pdf/unnamed-chunk-11-1.pdf}}

In the histogram, it is evident that the majority of values are
concentrated between 0 and 25. When comparing the mean and median for
both variables, with and without the outlier, the median demonstrates
greater stability irrespective of the outlier's presence. The medians
for both variables remain relatively similar, whereas the means show
significant variation, reflecting the mean's sensitivity to outliers.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary\_stats }\OtherTok{\textless{}{-}} 
\NormalTok{  outlier\_data\_long }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(Variable) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(Value),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(Value)}
\NormalTok{  )}
\NormalTok{summary\_stats}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 2 x 3
  Variable  mean median
  <chr>    <dbl>  <dbl>
1 normal    6.19      7
2 outlier  11         7
\end{verbatim}

Let's put the values of the mean and median onto a histogram so that we
can see how these values change in the presence of the outlier.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{outlier\_data\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Value, }\AttributeTok{fill =}\NormalTok{ Variable)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{bins =} \DecValTok{50}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ summary\_stats, }
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ mean, }\AttributeTok{color =}\NormalTok{ Variable), }
    \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{, }
    \AttributeTok{linewidth =} \FloatTok{0.8}
\NormalTok{    ) }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ summary\_stats, }
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ median, }\AttributeTok{color =}\NormalTok{ Variable), }
    \AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{, }
    \AttributeTok{linewidth =} \FloatTok{0.8}
\NormalTok{    ) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{, }\StringTok{"black"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Histograms of outlier data with mean and median"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Value"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Count"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"(Dashed line = mean, solid line = median)"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\AttributeTok{rows =} \FunctionTok{vars}\NormalTok{(Variable)) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}    
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"italic"}\NormalTok{)}
\NormalTok{    ) }
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{descriptive-stat_files/figure-pdf/unnamed-chunk-13-1.pdf}}

From the histograms, we can see the median (solid line) is relatively at
the same position while the mean (the dashed line) moves according to
the outlier.

Besides the sensitivity of the mean to the outliers, the mean is the
best measure of central tendency for normally distributed data because
it incorporates all data points and accurately reflects the centre of a
symmetric distribution. In a normal distribution, data points are
symmetrically distributed around the mean, and thus, the mean provides a
reliable measure of the ``typical'' value. However, it is to be noted
despite the mean being more preferred in normal distribution, the values
of median and mode are very close to the mean.

On the other hand, for the skewed distribution, the median is preferred
because it is not influenced by extreme values (outliers) that can
distort the mean. In a skewed distribution, where data points are
unevenly spread, the median represents the middle value, providing a
better reflection of the ``typical'' data point compared to the mean.
This makes the median more robust when dealing with outliers and skewed
data, as the mean may be pulled toward the skewed tail, giving a
misleading representation of central tendency.

Again, let's demonstrate this point in R. First, we create the data
consisting of two variables of normal and skewed distributions.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Create data}
\NormalTok{distribution\_data }\OtherTok{\textless{}{-}} 
  \FunctionTok{data.frame}\NormalTok{(}
    \AttributeTok{normal =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{500}\NormalTok{, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{),}
    \CommentTok{\# Create a skewed distribution variable (an exponential distribution with rate = 1)}
    \AttributeTok{skewed =} \FunctionTok{rexp}\NormalTok{(}\DecValTok{500}\NormalTok{, }\AttributeTok{rate =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Next, we need to change the data structure to a long data type to fully
explore the data.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{distribution\_data\_long }\OtherTok{\textless{}{-}} 
\NormalTok{  distribution\_data }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{names\_to =} \StringTok{"distribution"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"values"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

We going to plot the histogram to visualise the distributions.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{distribution\_data\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ values, }\AttributeTok{fill =}\NormalTok{ distribution)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{30}\NormalTok{, }\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\AttributeTok{rows =} \FunctionTok{vars}\NormalTok{(distribution)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Histogram of normal and skewed distribution data"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{descriptive-stat_files/figure-pdf/unnamed-chunk-16-1.pdf}}

Next, let's calculate the mean and median for each of the distributions.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary\_stat\_dist }\OtherTok{\textless{}{-}} 
\NormalTok{  distribution\_data\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(distribution) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarise}\NormalTok{(}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(values),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(values)}
\NormalTok{    )}
\NormalTok{summary\_stat\_dist}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# A tibble: 2 x 3
  distribution   mean median
  <chr>         <dbl>  <dbl>
1 normal       0.0346 0.0207
2 skewed       1.05   0.727 
\end{verbatim}

Notice that the mean and median for normal distribution are close while
skewed distribution is otherwise. Let's visualise the mean and median in
the histogram.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{distribution\_data\_long }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ values, }\AttributeTok{fill =}\NormalTok{ distribution)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{bins =} \DecValTok{50}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ summary\_stat\_dist, }
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ mean, }\AttributeTok{color =}\NormalTok{ distribution), }
    \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{, }
    \AttributeTok{linewidth =} \FloatTok{0.8}
\NormalTok{    ) }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ summary\_stat\_dist, }
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ median, }\AttributeTok{color =}\NormalTok{ distribution), }
    \AttributeTok{linetype =} \StringTok{"solid"}\NormalTok{, }
    \AttributeTok{linewidth =} \FloatTok{0.8}
\NormalTok{    ) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"black"}\NormalTok{, }\StringTok{"black"}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Normal and skewed distributions with their mean and median"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Value"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Count"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"(Dashed line = mean, solid line = median)"}
\NormalTok{    ) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\AttributeTok{rows =} \FunctionTok{vars}\NormalTok{(distribution)) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}    
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{,}
    \AttributeTok{plot.subtitle =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"italic"}\NormalTok{)}
\NormalTok{    ) }
\end{Highlighting}
\end{Shaded}

\pandocbounded{\includegraphics[keepaspectratio]{descriptive-stat_files/figure-pdf/unnamed-chunk-18-1.pdf}}

In the normal distribution, despite the values of mean and median being
close, the mean is preferred as it takes into account the whole range of
values mathematically. However, in the skewed distribution, the median
is preferred as it is less affected by the extreme values and sparsity
of the values as compared to the mean.

\subsubsection{Mode vs.~mean and median}\label{mode-vs.-mean-and-median}

Lastly, the mode is less useful for the data analysis compared to the
mean and median. Moreover, the mode may not be unique or exist in
certain datasets. Let's demonstrate these cases:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Mode values are not unique.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Values}
\NormalTok{two\_mode\_data }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"yes"}\NormalTok{, }\StringTok{"no"}\NormalTok{, }\StringTok{"unsure"}\NormalTok{, }\StringTok{"yes"}\NormalTok{, }\StringTok{"yes"}\NormalTok{, }\StringTok{"no"}\NormalTok{, }\StringTok{"no"}\NormalTok{)}

\CommentTok{\# Determine the mode}
\NormalTok{DescTools}\SpecialCharTok{::}\FunctionTok{Mode}\NormalTok{(two\_mode\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "no"  "yes"
attr(,"freq")
[1] 3
\end{verbatim}
\item
  Mode value does not exist.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Values}
\NormalTok{mode\_not\_exist }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"yes"}\NormalTok{, }\StringTok{"unsure"}\NormalTok{, }\StringTok{"no"}\NormalTok{)}

\CommentTok{\# Determine the mode}
\NormalTok{DescTools}\SpecialCharTok{::}\FunctionTok{Mode}\NormalTok{(mode\_not\_exist)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] NA
attr(,"freq")
[1] NA
\end{verbatim}
\end{enumerate}

\section{Measures of variability}\label{measures-of-variability}

Measures of variability describe the spread or dispersion of data points
in a dataset. These measures indicate how much the data values differ
from each other and from the central tendency (e.g., mean or median).

\subsection{Range}\label{range}

The range is the difference between maximum and minimum values in a
dataset.

\[
Range = Maximum - Minimum
\]

For example, the range for this range of values:

\[
1, 2, 5, 8, 10, 5
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Identify the maximum and minimum values.

  \[
  Maximum = 10, Minimum = 1
  \]
\item
  Calculate the range.

  \[
  10 - 1 = 9
  \]
\end{enumerate}

In R, we have a \texttt{range()} function. However, instead of giving a
range, the \texttt{range()} function returns a minimum and maximum
value.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The numeric values}
\NormalTok{x\_range }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{5}\NormalTok{)}

\CommentTok{\# Range function}
\FunctionTok{range}\NormalTok{(x\_range)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1]  1 10
\end{verbatim}

To calculate the range in R, we can utilise \texttt{max()} and
\texttt{min()} functions, which identify the maximum and minimum values,
respectively.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{max}\NormalTok{(x\_range) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(x\_range)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 9
\end{verbatim}

\subsection{Variance}\label{variance}

Variance measures the average squared difference of each data point from
the mean. It shows how data points spread around the mean in squared
units.

\[
Variance (s^{2}) = \frac{\sum (x_{i} - \overline{x})^{2}}{n-1}
\]

For example, to calculate the variance for these data points:

\[
3, 5, 6, 8, 2, 9
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Calculate the mean (\(\overline{x}\)).

  \[
  \frac{3 + 5 + 6 + 8 + 2 + 9}{6} = 5.5
  \]
\item
  Calculate the difference between each data point and mean, square it,
  and sum up all the squared differences
  (\(\sum (x_{i} - \overline{x})^{2}\)).

  \[
  (3-5.5)^{2}+(5-5.5)^{2}+(6-5.5)^{2}+(8-5.5)^{2}+(2-5.5)^{2}+(9-5.5)^{2} = 37.5
  \]
\item
  Divide the value by the count of the numbers (\(n-1\)).

  \[
  \frac{37.5}{6-1} = 7.5
  \]
\end{enumerate}

In R, we can calculate the variance using the \texttt{var()} function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The values}
\NormalTok{x\_variance }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{9}\NormalTok{)}

\CommentTok{\# Calculate variance}
\FunctionTok{var}\NormalTok{(x\_variance)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 7.5
\end{verbatim}

The equation that we used to calculate the variance manually and the one
in R is known as sample variance. There is another equation known as
population variance. The sample variance is used to describe the spread
out of the values in a sample, while population variance describes the
spread out of the values in a population.

\[
\begin{align*}
\text{Sample variance}(s^{2}) = \frac{\sum (x_{i} - \overline{x})^{2}}{n-1}\\
\text{Population variance}(\sigma^{2})= \frac{\sum (x_{i} - \mu)^{2}}{N}
\end{align*}
\]

Notice the slight differences in the denominators of the two equations.
Sample variance is calculated for a subset of data and includes an
adjustment for smaller sample sizes by dividing by \(n-1\) instead of
\(n\). This correction (known as Bessel's correction) ensures that the
sample variance is an unbiased estimate of the population variance. In
contrast, population variance is calculated for the entire dataset and
does not require this adjustment. Additionally, instead of using sample
mean (\(\overline{x}\)), population variance is using the population
mean (\(\mu\)).

In practical data analysis, we are almost always working with a sample
rather than the entire population. As a result, the formula for sample
variance is typically used to estimate the variability of the dataset.

\subsection{Standard deviation}\label{standard-deviation}

Standard deviation is the square root of the variance, providing a
measure of dispersion in the same units as the data. A smaller value
indicates less variability and a larger value indicates greater
variability.

\[
\text{Standard deviation}(SD) = \sqrt{Variance}
\]

For example, to calculate the standard deviation for these numbers:

\[
3, 5, 6, 8, 2, 9
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Calculate the sample variance (\(s^{2}\)).

  \[
  \frac{(3-5.5)^{2}+(5-5.5)^{2}+(6-5.5)^{2}+(8-5.5)^{2}+(2-5.5)^{2}+(9-5.5)^{2}}{6-1} = 7.5
  \]
\item
  Square root the sample variance (\(s^{2}\)).

  \[
  \sqrt{7.5} = 2.74
  \]
\end{enumerate}

In R, we can use the \texttt{sd()} function to calculate the standard
deviation, This function uses sample variance to calculate the standard
deviation.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The values}
\NormalTok{x\_sd }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{9}\NormalTok{)}

\CommentTok{\# Calculate variance}
\FunctionTok{sd}\NormalTok{(x\_sd)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 2.738613
\end{verbatim}

\subsection{Interquartile range}\label{interquartile-range}

The interquartile range describes the range of the middle 50\% of the
data (the difference between the third quartile and first quartile).

\[
\text{Interquartile range}(IQR) = Q_{3} - Q_{1}
\]

To calculate the interquartile range for these numbers:

\[
3, 5, 6, 8, 2, 9
\]

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Divide the data into lower half and upper half

  \[
  \begin{align*}
  \text{Lower half} = 2, 3, 5\\
  \text{Upper half} = 6, 8, 9
  \end{align*}
  \]
\item
  Identify the median of the lower half (first quartile, \(Q_{1}\)) and
  the median of the upper half (third quartile, \(Q_{3}\)).

  \[
  \begin{align*}
  \text{Median of lower half}(Q_{1}) = 3\\
  \text{Median of the upper half} (Q_{3}) = 8
  \end{align*}
  \]
\item
  Calculate the interquartile range.

  \[
  8-3 = 5
  \]
\end{enumerate}

In R, we can use \texttt{IQR()} to calculate the interquartile range.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# The values}
\NormalTok{x\_iqr }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{9}\NormalTok{)}

\CommentTok{\# Calculate interquartile range}
\FunctionTok{IQR}\NormalTok{(x\_iqr, }\AttributeTok{type =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5
\end{verbatim}

\texttt{IQR()} actually uses the \texttt{quantile()} function to
calculate the quartiles, subsequently calculating the interquartile
range. \texttt{quantile()} with \texttt{type\ =\ 2} reflects the exact
first and the third quartile that we manually calculate.
\texttt{quantile()} and \texttt{IQR()} have 9 types of algorithms or
formulas to calculate the quartile in R. The default, both functions use
\texttt{type\ =\ 7}. However, Hyndman \& Fan proposed to use type 8
(1996).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Quantile type 2 reflects our manual calculation}
\FunctionTok{quantile}\NormalTok{(x\_iqr, }\AttributeTok{type =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  0%  25%  50%  75% 100% 
 2.0  3.0  5.5  8.0  9.0 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# IQR type 2 reflects our manual calculation}
\FunctionTok{IQR}\NormalTok{(x\_iqr, }\AttributeTok{type =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Quantile type 7 is the default}
\CommentTok{\# We don\textquotesingle{}t actually need to specify the type since it is the default}
\FunctionTok{quantile}\NormalTok{(x\_iqr, }\AttributeTok{type =} \DecValTok{7}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  0%  25%  50%  75% 100% 
 2.0  3.5  5.5  7.5  9.0 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# IQR type 7 is the default}
\FunctionTok{IQR}\NormalTok{(x\_iqr, }\AttributeTok{type =} \DecValTok{7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Quantile type 8 }
\FunctionTok{quantile}\NormalTok{(x\_iqr, }\AttributeTok{type =} \DecValTok{8}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
      0%      25%      50%      75%     100% 
2.000000 2.916667 5.500000 8.083333 9.000000 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# IQR type 8 }
\FunctionTok{IQR}\NormalTok{(x\_iqr, }\AttributeTok{type =} \DecValTok{8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] 5.166667
\end{verbatim}

Briefly, I suggest using \texttt{type\ =\ 7} or \texttt{type\ =\ 8} for
calculating the quartile and interquartile range. For accuracy, we can
use \texttt{type\ =\ 8} as proposed by Hyndman \& Fan(1996). For
simplicity, we can use \texttt{type\ =\ 7} as it is the default in R and
widely used in other statistical software as well.

\section{Packages for descriptive
statistics}\label{packages-for-descriptive-statistics}

We have covered in Section~\ref{sec-data-explore-useful-packages}
several general packages for data exploration which includes descriptive
statistics. In this, section we going to explore two useful packages for
descriptive statistics: \texttt{summarytools} and \texttt{gtsummary}. It
is to be noted that there are several other R packages available for
descriptive statistics, to name a few: \texttt{psych}, \texttt{pastecs},
and \texttt{Hmisc}.

\subsection{summarytools}\label{summarytools}

\texttt{summarytools} provides an easy-to-use function for descriptive
statistics. For numerical variables, we can use \texttt{descr()}. We
going to use the \texttt{iris} dataset to demonstrate the capabilities
of \texttt{summarytools}. More details on the \texttt{iris} dataset can
be read by typing \texttt{?iris} in the

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load packages}
\FunctionTok{library}\NormalTok{(summarytools)}

\CommentTok{\# Descriptive statistics for numerical data}
\FunctionTok{descr}\NormalTok{(iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Descriptive Statistics  
iris  
N: 150  

                    Petal.Length   Petal.Width   Sepal.Length   Sepal.Width
----------------- -------------- ------------- -------------- -------------
             Mean           3.76          1.20           5.84          3.06
          Std.Dev           1.77          0.76           0.83          0.44
              Min           1.00          0.10           4.30          2.00
               Q1           1.60          0.30           5.10          2.80
           Median           4.35          1.30           5.80          3.00
               Q3           5.10          1.80           6.40          3.30
              Max           6.90          2.50           7.90          4.40
              MAD           1.85          1.04           1.04          0.44
              IQR           3.50          1.50           1.30          0.50
               CV           0.47          0.64           0.14          0.14
         Skewness          -0.27         -0.10           0.31          0.31
      SE.Skewness           0.20          0.20           0.20          0.20
         Kurtosis          -1.42         -1.36          -0.61          0.14
          N.Valid         150.00        150.00         150.00        150.00
                N         150.00        150.00         150.00        150.00
        Pct.Valid         100.00        100.00         100.00        100.00
\end{verbatim}

We can see that \texttt{descr()} returns several familiar measures for
descriptive statistics such as mean, standard deviation
(\texttt{Std.Dev}), minimum value, maximum value, median, first and
third quartile. There are several other measures that we have not
covered previously:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{MAD}:

  \begin{itemize}
  \tightlist
  \item
    Describes the median of the absolute deviations of the data points
    from the median of the dataset.
  \item
    A small MAD indicates that most data points are close to the median,
    reflecting low variability and a large MAD suggests greater spread,
    meaning data points are more dispersed from the median.
  \item
    Unlike the variance and standard deviation is less sensitive to
    outliers, thus, making it more suitable for a skewed distribution.
  \end{itemize}
\item
  \texttt{CV}:

  \begin{itemize}
  \item
    CV or coefficient of variation is a relative measure of variability.
    It reflects the ratio of standard deviation (\(s^{2}\)) to the mean
    (\(\overline{x}\)).
  \item
    \[
    \begin{align*}
    CV = \frac{s^{2}}{\overline{x}}\\
    0.47 =\frac{1.77}{3.76}
    \end{align*}
    \]
  \item
    Low CV indicates less variability relative to the mean, suggesting
    consistency and uniformity in the dataset, while high CV indicates
    greater variability relative to the mean, which could imply
    inconsistency or a wide spread of data values.
  \item
    There is no exact value of CV that we can rate the variability of
    the data, however, as a rule of thumb:

    \begin{itemize}
    \tightlist
    \item
      CV \textless{} 0.3 indicates a low variability and spread which
      can be considered as good.
    \item
      CV \textgreater{} 0.3 indicates a high variability, thus,
      requiring us to inspect the data distribution further.
    \end{itemize}
  \item
    We can recall the CV of each of the numeric variables in the
    \texttt{iris} dataset.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{descr}\NormalTok{(iris }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{Species),}
      \AttributeTok{stats =} \FunctionTok{c}\NormalTok{(}\StringTok{"CV"}\NormalTok{, }\StringTok{"mean"}\NormalTok{, }\StringTok{"sd"}\NormalTok{),}
      \AttributeTok{transpose =} \ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{headings =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

                       CV   Mean   Std.Dev
------------------ ------ ------ ---------
      Petal.Length   0.47   3.76      1.77
       Petal.Width   0.64   1.20      0.76
      Sepal.Length   0.14   5.84      0.83
       Sepal.Width   0.14   3.06      0.44
\end{verbatim}
  \item
    Subsequently, we can reflect the values of CV for each numeric
    variable in the \texttt{iris} dataset to their respective histogram.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{names\_to =} \StringTok{"variable"}\NormalTok{, }\AttributeTok{values\_to =} \StringTok{"values"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ values, }\AttributeTok{fill =}\NormalTok{ variable)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.6}\NormalTok{, }\AttributeTok{bins =} \DecValTok{30}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(}\AttributeTok{rows =} \FunctionTok{vars}\NormalTok{(variable)) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

    \pandocbounded{\includegraphics[keepaspectratio]{descriptive-stat_files/figure-pdf/unnamed-chunk-29-1.pdf}}
  \end{itemize}
\item
  \texttt{Skewness} and \texttt{SE.skewness}

  \begin{itemize}
  \tightlist
  \item
    Skewness describes the symmetry of the distribution of the data.
  \item
    As a rule of thumb (Hair et al. 2022):

    \begin{itemize}
    \tightlist
    \item
      Skewness \(\approx\) 0: indicates the data is nearly symmetry.
    \item
      -1 \textless{} Skewness \textless{} 1: indicates a low skewness,
      which is excellent.
    \item
      -2 \textless{} Skewness \textless{} 2: indicates a moderate
      skewness, which is acceptable.
    \item
      Skewness \textgreater{} 2 or Skewness \textless{} -2: indicates a
      substantial skewness, in which data distribution is not normal.
    \end{itemize}
  \item
    A positive value indicates the tail of the histogram is longer on
    the right, indicating more extreme high values, while the negative
    skewness indicates the tail of the histogram is longer on the left,
    indicating more extreme low values.
  \item
    Comparing skewness to the standard error (SE) of the skewness helps
    decide whether the asymmetry is meaningful or due to random
    variation in the sample.
  \item
    \[
    \frac{Skewness}{SE.skewness} > \pm 1.96 = \text{significant skewness}
    \]
  \end{itemize}
\item
  \texttt{Kurtosis}

  \begin{itemize}
  \tightlist
  \item
    Kurtosis is a statistical measure that evaluates the extent to which
    data points cluster in the tails or the peak of the distribution
    compared to a normal distribution.
  \item
    In simpler words, kurtosis indicates whether the data distribution
    is too ``thin'' or ``broad'' compared to a normal distribution.
  \item
    Kurtosis and skewness are typically interpreted together to assess
    the shape of a data distribution. When both values are close to 0,
    it suggests that the data approximates a normal distribution.
  \item
    As a rule of thumb (Hair et al. 2022):

    \begin{itemize}
    \tightlist
    \item
      Kurtosis \(\approx\) 0: data approximate a normal distribution.
    \item
      Kurtosis \textgreater{} 2: data has a peaked distribution.
    \item
      Kurtosis \textless{} -2: data has a flat distribution.
    \end{itemize}
  \end{itemize}
\item
  \texttt{N.Valid}: number of observations that is not a missing value.
\item
  \texttt{Pct.Valid}: percentage of the observations that is not a
  missing value.
\end{enumerate}

Additionally, we can get descriptive statistics based on certain
variables. For example, we can get the descriptive statistics of the
numerical variables in the \texttt{iris} dataset according to the
\texttt{species}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{descr}\NormalTok{(Petal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Descriptive Statistics  
Petal.Length by Species  
Data Frame: iris  
N: 150  

                    setosa   versicolor   virginica
----------------- -------- ------------ -----------
             Mean     1.46         4.26        5.55
          Std.Dev     0.17         0.47        0.55
              Min     1.00         3.00        4.50
               Q1     1.40         4.00        5.10
           Median     1.50         4.35        5.55
               Q3     1.60         4.60        5.90
              Max     1.90         5.10        6.90
              MAD     0.15         0.52        0.67
              IQR     0.18         0.60        0.78
               CV     0.12         0.11        0.10
         Skewness     0.10        -0.57        0.52
      SE.Skewness     0.34         0.34        0.34
         Kurtosis     0.65        -0.19       -0.37
          N.Valid    50.00        50.00       50.00
                N    50.00        50.00       50.00
        Pct.Valid   100.00       100.00      100.00
\end{verbatim}

For the descriptive statistics for the categorical variables, we can use
the \texttt{freq()} function which calculates count and percentage.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Descriptive statistics for categorical data}
\FunctionTok{freq}\NormalTok{(iris}\SpecialCharTok{$}\NormalTok{Species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Frequencies  
iris$Species  
Type: Factor  

                   Freq   % Valid   % Valid Cum.   % Total   % Total Cum.
---------------- ------ --------- -------------- --------- --------------
          setosa     50     33.33          33.33     33.33          33.33
      versicolor     50     33.33          66.67     33.33          66.67
       virginica     50     33.33         100.00     33.33         100.00
            <NA>      0                               0.00         100.00
           Total    150    100.00         100.00    100.00         100.00
\end{verbatim}

Lastly, we can do a cross-tabulation between two categorical variables.
To demonstrate this function, we need to create an additional
categorical variable for the \texttt{iris} dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create a new categorical variable}
\NormalTok{dat }\OtherTok{\textless{}{-}} 
\NormalTok{  iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{Sepal\_Length\_Cat =} \FunctionTok{ifelse}\NormalTok{(Sepal.Length }\SpecialCharTok{\textgreater{}} \DecValTok{5}\NormalTok{, }\StringTok{"large"}\NormalTok{, }\StringTok{"small"}\NormalTok{)) }

\CommentTok{\# Cross{-}tabulation}
\FunctionTok{ctable}\NormalTok{(dat}\SpecialCharTok{$}\NormalTok{Sepal\_Length\_Cat, dat}\SpecialCharTok{$}\NormalTok{Species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Cross-Tabulation, Row Proportions  
Sepal_Length_Cat * Species  
Data Frame: dat  

------------------ --------- ------------ ------------ ------------ --------------
                     Species       setosa   versicolor    virginica          Total
  Sepal_Length_Cat                                                                
             large             22 (18.6%)   47 (39.8%)   49 (41.5%)   118 (100.0%)
             small             28 (87.5%)    3 ( 9.4%)    1 ( 3.1%)    32 (100.0%)
             Total             50 (33.3%)   50 (33.3%)   50 (33.3%)   150 (100.0%)
------------------ --------- ------------ ------------ ------------ --------------
\end{verbatim}

The first variable will appear as row names and the second variable will
appear as column names. In our code, \texttt{Sepal\_Length\_Cat} will
appear as a row, and \texttt{Species} will appear as a column.

\subsection{gtsummary}\label{gtsummary}

The \texttt{gtsummary} package provides an easy way to create a
publication-ready summary table. We going to use the \texttt{iris}
dataset to demonstrate the capabilities of \texttt{gtsummary}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load packages}
\FunctionTok{library}\NormalTok{(gtsummary)}

\CommentTok{\# Create a summary table}
\FunctionTok{tbl\_summary}\NormalTok{(}\AttributeTok{data =}\NormalTok{ iris)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\fontsize{12.0pt}{14.0pt}\selectfont
\begin{tabular*}{\linewidth}{@{\extracolsep{\fill}}lc}
\toprule
\textbf{Characteristic} & \textbf{N = 150}\textsuperscript{\textit{1}} \\ 
\midrule\addlinespace[2.5pt]
Sepal.Length & 5.80 (5.10, 6.40) \\ 
Sepal.Width & 3.00 (2.80, 3.30) \\ 
Petal.Length & 4.35 (1.60, 5.10) \\ 
Petal.Width & 1.30 (0.30, 1.80) \\ 
Species &  \\ 
setosa & 50 (33\%) \\ 
versicolor & 50 (33\%) \\ 
virginica & 50 (33\%) \\ 
\bottomrule
\end{tabular*}
\begin{minipage}{\linewidth}
\textsuperscript{\textit{1}}Median (Q1, Q3); n (\%)\\
\end{minipage}
\end{table}

We can further adjust this summary table. For example, we can:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Change the median (Q1, Q3) to the mean and standard deviation.
\item
  Change all values to 1 decimal point.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tbl\_summary}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ iris,}
  \AttributeTok{statistic =} \FunctionTok{all\_continuous}\NormalTok{() }\SpecialCharTok{\textasciitilde{}} \StringTok{"\{mean\} (\{sd\})"}\NormalTok{, }\CommentTok{\# Use mean and standard deviation}
  \AttributeTok{digits =} \FunctionTok{list}\NormalTok{(}\FunctionTok{all\_continuous}\NormalTok{() }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{, }\CommentTok{\# numerical variables to 1 decimal place}
                \FunctionTok{all\_categorical}\NormalTok{() }\SpecialCharTok{\textasciitilde{}} \DecValTok{1}\NormalTok{) }\CommentTok{\# categorical variable to 1 decimal place}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}
\fontsize{12.0pt}{14.0pt}\selectfont
\begin{tabular*}{\linewidth}{@{\extracolsep{\fill}}lc}
\toprule
\textbf{Characteristic} & \textbf{N = 150}\textsuperscript{\textit{1}} \\ 
\midrule\addlinespace[2.5pt]
Sepal.Length & 5.8 (0.8) \\ 
Sepal.Width & 3.1 (0.4) \\ 
Petal.Length & 3.8 (1.8) \\ 
Petal.Width & 1.2 (0.8) \\ 
Species &  \\ 
setosa & 50.0 (33.3\%) \\ 
versicolor & 50.0 (33.3\%) \\ 
virginica & 50.0 (33.3\%) \\ 
\bottomrule
\end{tabular*}
\begin{minipage}{\linewidth}
\textsuperscript{\textit{1}}Mean (SD); n (\%)\\
\end{minipage}
\end{table}

\section{Chapter summary}\label{chapter-summary-8}

In this chapter, we have covered the basic descriptive statistics, which
is consist of:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Measures of central tendency.
\item
  Measures of variability.
\end{enumerate}

We have learned how to interpret and implement each measure in R.
Additionally, we have covered two useful R packages for descriptive
statistics:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{summarytools}
\item
  \texttt{gtsummary}
\end{enumerate}

For more information on \texttt{summarytools} (Comtois 2022), refer to
its
\href{https://cran.r-project.org/web/packages/summarytools/vignettes/introduction.html}{official
documentation}. Similarly, detailed guidance on \texttt{gtsummary}
(Sjoberg et al. 2021) is available on
\href{https://www.danieldsjoberg.com/gtsummary/}{its documentation
page}.

\section{Revision}\label{revision-8}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Explain measures of central tendency.
\item
  Explain measures of variability.
\item
  What is the relationship of outliers with mean, median, and mode?
\item
  Explain the differences between sample variance and population
  variance.
\item
  Read about \texttt{airquality} data by typing \texttt{?airquality} in
  the \texttt{Console}. Next, using the data:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"airquality"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    Find the median for each numerical variable in the dataset.
  \item
    Using \texttt{summarytools}, get descriptive statistics for all
    variables.
  \item
    Create a summary table using the \texttt{gtsummary} package.
  \end{enumerate}
\item
  Read about \texttt{CO2} data by typing \texttt{?CO2} in the
  \texttt{Console}. Next, using the data:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"CO2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \item
    Get descriptive statistics for \texttt{uptake} stratified by
    \texttt{Type}.
  \item
    Create cross-tabulation between \texttt{Type} and \texttt{Treatment}
    with the former as a row and the latter as a column.
  \end{enumerate}
\end{enumerate}

\bookmarksetup{startatroot}

\chapter{A way forward}\label{a-way-forward}

This book has provided a strong foundation for mastering R in the
context of data analysis. However, R is an expansive tool with
applications in numerous fields, and there are many avenues for further
exploration once you have completed this book.

Generally, the field of data analysis is diverse and continually
evolving. Here are three major areas that I can suggest to consider as
part of your journey forward:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Statistical Analysis and Modeling\\
  Statistical analysis forms the backbone of data-driven
  decision-making. It involves descriptive techniques to summarize data
  and inferential methods to draw conclusions and test hypotheses. With
  R, you can perform regression analysis, ANOVA, time series
  forecasting, and multivariate analysis, among others.
\item
  Machine Learning\\
  Machine learning builds on statistical methods to create algorithms
  capable of learning from data. R offers robust tools for machine
  learning, including packages like \texttt{caret}, \texttt{tidymodels},
  and \texttt{mlr3}. These tools support tasks such as classification,
  clustering, and predictive modeling. R's integration with deep
  learning libraries, like \texttt{tensorflow}, \texttt{keras}, and
  \texttt{torch}, also enables work in neural networks and reinforcement
  learning.
\item
  Data visualisation and communication\\
  Effective communication of results is key in data analysis. R's
  visualization capabilities, through tools like \texttt{ggplot2},
  \texttt{plotly}, and \texttt{shiny}, allow analysts to create dynamic,
  interactive, and publication-ready visualizations. Mastering these
  tools helps ensure that insights are clearly conveyed to both
  technical and non-technical audiences.
\end{enumerate}

Wrapping up, mastering R isn't just about knowing the basics---it's your
ticket to exploring a ton of exciting opportunities in data analysis and
beyond. Whether you're diving into statistical analysis to uncover
trends or exploring the cutting-edge world of machine learning, R has
got you covered. Plus, its powerful tools for creating stunning
visualizations and tackling big data make it a must-have for any data
enthusiast.

As you build on the foundation you've gained, think about where you want
to specialize. Maybe it's predictive modeling, visual storytelling
through data, or even solving big, messy real-world problems. The
possibilities are endless---so keep learning, experimenting, and pushing
boundaries.

\bookmarksetup{startatroot}

\chapter*{References}\label{references}
\addcontentsline{toc}{chapter}{References}

\markboth{References}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-summarytools}
Comtois, Dominic. 2022. \emph{Summarytools: Tools to Quickly and Neatly
Summarize Data}. \url{https://CRAN.R-project.org/package=summarytools}.

\bibitem[\citeproctext]{ref-dataexplorer-cui2024}
Cui, Boxuan. 2024. \emph{DataExplorer: Automate Data Exploration and
Treatment}. \url{http://boxuancui.github.io/DataExplorer/}.

\bibitem[\citeproctext]{ref-hair2022}
Hair, Joseph F., G. Tomas M. Hult, Christian M. Ringle, and Marko
Sarstedt. 2022. \emph{A Primer on Partial Least Squares Structural
Equation Modeling (PLS-SEM)}. SAGE Publications, Inc.

\bibitem[\citeproctext]{ref-Hyndman1996}
Hyndman, Rob J., and Yanan Fan. 1996. {``Sample Quantiles in Statistical
Packages.''} \emph{The American Statistician} 50 (4): 361--65.
\url{https://doi.org/10.1080/00031305.1996.10473566}.

\bibitem[\citeproctext]{ref-vim-kowarik2016}
Kowarik, Alexander, and Matthias Templ. 2016. {``Imputation with the r
Package VIM.''} \emph{Journal of Statistical Software} 74 (7): 1--16.
\url{https://doi.org/10.18637/jss.v074.i07}.

\bibitem[\citeproctext]{ref-dlookr-ryu2024}
Ryu, Choonghyun. 2024. \emph{Dlookr: Tools for Data Diagnosis,
Exploration, Transformation}.
\url{https://CRAN.R-project.org/package=dlookr}.

\bibitem[\citeproctext]{ref-gtsummary}
Sjoberg, Daniel D., Karissa Whiting, Michael Curry, Jessica A. Lavery,
and Joseph Larmarange. 2021. {``Reproducible Summary Tables with the
Gtsummary Package.''} \emph{{The R Journal}} 13: 570--80.
\url{https://doi.org/10.32614/RJ-2021-053}.

\bibitem[\citeproctext]{ref-naniar-tierney2023}
Tierney, Nicholas, and Dianne Cook. 2023. {``Expanding Tidy Data
Principles to Facilitate Missing Data Exploration, Visualization and
Assessment of Imputations.''} \emph{Journal of Statistical Software} 105
(7): 1--31. \url{https://doi.org/10.18637/jss.v105.i07}.

\bibitem[\citeproctext]{ref-skimr-rubia2024}
Waring, Elin, Michael Quinn, Amelia McNamara, Eduardo Arino de la Rubia,
Hao Zhu, and Shannon Ellis. 2024. \emph{Skimr: Compact and Flexible
Summaries of Data}. \url{https://docs.ropensci.org/skimr/}.

\bibitem[\citeproctext]{ref-ggplot2}
Wickham, Hadley. 2016. \emph{Ggplot2: Elegant Graphics for Data
Analysis}. Springer-Verlag New York.
\url{https://ggplot2.tidyverse.org}.

\bibitem[\citeproctext]{ref-tidyverse}
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy
D'Agostino McGowan, Romain Franois, Garrett Grolemund, et al. 2019.
{``Welcome to the {tidyverse}.''} \emph{Journal of Open Source Software}
4 (43): 1686. \url{https://doi.org/10.21105/joss.01686}.

\bibitem[\citeproctext]{ref-wickham2023r}
Wickham, Hadley, Mine etinkaya-Rundel, and Garrett Grolemund. 2023.
\emph{R for Data Science}. O'Reilly Media, Inc.

\bibitem[\citeproctext]{ref-wickham2017r}
Wickham, Hadley, and Garrett Grolemund. 2017. \emph{R for Data Science}.
O'Reilly Media, Inc.

\end{CSLReferences}




\end{document}
